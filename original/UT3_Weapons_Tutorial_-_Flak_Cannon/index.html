<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" /><title>UT3 Weapons Tutorial - Flak Cannon - Epic Wiki</title>
<meta name="generator" content="MediaWiki 1.22.2" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="Epic Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.unrealengine.com/api.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Epic Wiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="https://wiki.unrealengine.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cskins.vector&amp;only=styles&amp;skin=epic&amp;*" />
<link rel="stylesheet" href="/extensions/EpicVideoSystem/CSS/VideoSystem.css" />
<link rel="stylesheet" href="/skins/epic/resources/screen.css?303" media="screen" />
<link rel="stylesheet" href="/skins/epic/resources/epic.css?303" media="screen" />
<link rel="stylesheet" href="/skins/epic/resources/prettify.css?303" media="screen" />
<link rel="stylesheet" href="/skins/epic/resources/jquery.qtip.css?303" media="screen" /><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="https://wiki.unrealengine.com/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=epic&amp;*" />
<style>a:lang(ar),a:lang(ckb),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: my_wiki:resourceloader:filter:minify-css:7:07b6a8ccf3fd62e770f192d0a6f8e123 */</style>

<script src="https://wiki.unrealengine.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=epic&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"UT3_Weapons_Tutorial_-_Flak_Cannon","wgTitle":"UT3 Weapons Tutorial - Flak Cannon","wgCurRevisionId":10610,"wgRevisionId":10610,"wgArticleId":1947,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Unreal Tournament","UT Content Creation"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"UT3_Weapons_Tutorial_-_Flak_Cannon","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"hidesig":true,"templateEditor":false,"templates":false,"preview":true,"previewDialog":false,"publish":true,"toc":false}});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function(){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"epic","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"vector-simplesearch":1,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,
"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"useeditwarning":1,"prefershttps":1,"usebetatoolbar":1,"usebetatoolbar-cgd":1,"wikieditor-preview":1,"wikieditor-publish":1,"language":"en","variant-gan":"gan","variant-iu":"iu","variant-kk":"kk","variant-ku":"ku","variant-shi":"shi","variant-sr":"sr","variant-tg":"tg","variant-uz":"uz","variant-zh":"zh","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"variant":"en"});},{},{});mw.loader.implement("user.tokens",function(){mw.user.tokens.set({"editToken":"+\\","patrolToken":false,"watchToken":false});},{},{});
/* cache key: my_wiki:resourceloader:filter:minify-js:7:2197af7670c41256853f340e275ede1b */
}</script>
<script src="https://wiki.unrealengine.com/load.php?debug=false&amp;lang=en&amp;modules=skins.epic.extras.js%7Cskins.epic.fancybox.js%7Cskins.epic.js%7Cskins.epic.qtip.js%7Cskins.epic.slimscroll.js&amp;only=scripts&amp;skin=epic&amp;*"></script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<style type="text/css">/*<![CDATA[*/
.source-cpp {line-height: normal;}
.source-cpp li, .source-cpp pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for cpp
 * CSS class: source-cpp, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.cpp.source-cpp .de1, .cpp.source-cpp .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.cpp.source-cpp  {font-family:monospace;}
.cpp.source-cpp .imp {font-weight: bold; color: red;}
.cpp.source-cpp li, .cpp.source-cpp .li1 {font-weight: normal; vertical-align:top;}
.cpp.source-cpp .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.cpp.source-cpp .li2 {font-weight: bold; vertical-align:top;}
.cpp.source-cpp .kw1 {color: #0000ff;}
.cpp.source-cpp .kw2 {color: #0000ff;}
.cpp.source-cpp .kw3 {color: #0000dd;}
.cpp.source-cpp .kw4 {color: #0000ff;}
.cpp.source-cpp .co1 {color: #666666;}
.cpp.source-cpp .co2 {color: #339900;}
.cpp.source-cpp .coMULTI {color: #ff0000; font-style: italic;}
.cpp.source-cpp .es0 {color: #000099; font-weight: bold;}
.cpp.source-cpp .es1 {color: #000099; font-weight: bold;}
.cpp.source-cpp .es2 {color: #660099; font-weight: bold;}
.cpp.source-cpp .es3 {color: #660099; font-weight: bold;}
.cpp.source-cpp .es4 {color: #660099; font-weight: bold;}
.cpp.source-cpp .es5 {color: #006699; font-weight: bold;}
.cpp.source-cpp .br0 {color: #008000;}
.cpp.source-cpp .sy0 {color: #008000;}
.cpp.source-cpp .sy1 {color: #000080;}
.cpp.source-cpp .sy2 {color: #000040;}
.cpp.source-cpp .sy3 {color: #000040;}
.cpp.source-cpp .sy4 {color: #008080;}
.cpp.source-cpp .st0 {color: #FF0000;}
.cpp.source-cpp .nu0 {color: #0000dd;}
.cpp.source-cpp .nu6 {color: #208080;}
.cpp.source-cpp .nu8 {color: #208080;}
.cpp.source-cpp .nu12 {color: #208080;}
.cpp.source-cpp .nu16 {color:#800080;}
.cpp.source-cpp .nu17 {color:#800080;}
.cpp.source-cpp .nu18 {color:#800080;}
.cpp.source-cpp .nu19 {color:#800080;}
.cpp.source-cpp .me1 {color: #007788;}
.cpp.source-cpp .me2 {color: #007788;}
.cpp.source-cpp .ln-xtra, .cpp.source-cpp li.ln-xtra, .cpp.source-cpp div.ln-xtra {background-color: #ffc;}
.cpp.source-cpp span.xtra { display:block; }

/*]]>*/
</style><!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/epic/csshover.min.htc")}</style><![endif]--><script type="text/javascript">
var experimentID = false;
var cxApi = null;
var variation = 0;
var fancyTitle = "";
var CE_SNAPSHOT_NAME = document.getElementsByTagName("title")[0].innerHTML;
$(document).ready(function(){
	if(experimentID != false)
	{
		$(head).append('<script src="//www.google-analytics.com/cx/api.js?experiment=' + experimentID + '" />' + '</scr' + 'ipt>');
		HandleExperiment();
	}
	else
	{
		CE_SNAPSHOT_NAME = (fancyTitle != "" ? fancyTitle : document.getElementsByTagName("title")[0].innerHTML);
		setTimeout(function () {
			var a = document.createElement("script");
			var b = document.getElementsByTagName("script")[0];
			a.src = document.location.protocol + "//script.crazyegg.com/pages/scripts/0028/4572.js?" + Math.floor(new Date().getTime() / 3600000);
			a.async = true; a.type = "text/javascript"; b.parentNode.insertBefore(a, b)
		}, 1);	
	}
});
function HandleExperiment()
{
	CE_SNAPSHOT_NAME = (fancyTitle != "" ? fancyTitle : document.getElementsByTagName("title")[0].innerHTML);
	if(cxApi != null)
	{
		variation = cxApi.chooseVariation();
		cxApi.setChosenVariation(variation, experimentID);
		if(variation != cxApi.ORIGINAL_VARIATION && variation != cxApi.NO_CHOSEN_VARIATION && variation != cxApi.NOT_PARTICIPATING)
		{
			//var URL = document.location.href + (document.location.search != '' ? '&var=' : '?var=') + variation;
			ga('send', 'event', 'A/B', 'ID: ' + experimentID, 'Variation: ' + variation, {'nonInteraction': 1});
			//document.location.href = URL; 
			CE_SNAPSHOT_NAME = document.getElementsByTagName("title")[0].innerHTML + ' (variation ' + variation + ')';
			var test = "";
		}
		else
		{
			ga('send', 'event', 'A/B', 'ID: ' + experimentID, 'Variation: ' + variation, {'nonInteraction': 1});
		}
		ToggleExperimentContent(variation);
		setTimeout(function () {
			var a = document.createElement("script");
			var b = document.getElementsByTagName("script")[0];
			a.src = document.location.protocol + "//script.crazyegg.com/pages/scripts/0028/4572.js?" + Math.floor(new Date().getTime() / 3600000);
			a.async = true; a.type = "text/javascript"; b.parentNode.insertBefore(a, b)
		}, 1);
	}
	else
	{
		setTimeout("HandleExperiment()", 500);
	}
}

function ToggleExperimentContent(variation)
{
	$('.AB').hide();
	$('#variation_' + variation).show();
}
</script></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-UT3_Weapons_Tutorial_-_Flak_Cannon skin-epic action-view vector-animateLayout">
		<!--<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>-->
		<!-- Google Tag Manager -->
		<noscript>
			<iframe src="//www.googletagmanager.com/ns.html?id=GTM-KWRD6D"
					height="0" width="0" style="display:none;visibility:hidden"></iframe>
		</noscript>
		<script>
		(function (w, d, s, l, i) {
		w[l] = w[l] || []; w[l].push({
		'gtm.start':
		new Date().getTime(), event: 'gtm.js'
		}); var f = d.getElementsByTagName(s)[0],
		j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
		'//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
		})(window, document, 'script', 'dataLayer', 'GTM-KWRD6D');</script>
		<!-- End Google Tag Manager -->
		<div id="webThree">
		<div id="head">
		









<!DOCTYPE html>
<html>
    <head>
        <script src="https://cdn1.unrealengine.com/2957168/epicGamesHeaderBundle-ea9716b3af72a5815cd9065b9c653fd6.js" defer></script>
        <link rel="stylesheet" href="https://cdn1.unrealengine.com/2957168/epicGamesHeader-d8854194f8c763b7fad3d04f3bb362d6.css">
    </head>

    <body>
        <input type="hidden" id="updateenable" value="true">

        
            

<!DOCTYPE html>
<html>
    <head>
    	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
        
            <link rel="stylesheet" href="https://cdn1.unrealengine.com/2957168/webpack/epicGamesHeader.epic-games-nav-a90544978176b7c2b2f8fb7724618a98.css"/>
        
    </head>
    <body>
        <script type="text/javascript">
            //required so the config object is not utf-8 encoded
            
                (function() {
                    var config = (function(){ return {"macDownloadUrl":"https://launcher-public-service-prod06.ol.epicgames.com/launcher/api/installer/download/EpicGamesLauncher.dmg","hideSearch":false,"_contentType":426,"links":[{"title":"About","useCustomCallback":false,"kids":[{"title":"Overview","href":"https://www.unrealengine.com/what-is-unreal-engine-4"},{"title":"Features","href":"https://www.unrealengine.com/unreal-engine-4"},{"title":"Virtual Reality","href":"https://www.unrealengine.com/vr-page"},{"title":"Showcase","href":"https://www.unrealengine.com/showcase"},{"title":"What's New","href":"https://www.unrealengine.com/411-release-notes-overview"},{"title":"FAQ / EULA","href":"https://www.unrealengine.com/faq"},{"title":"Previous Versions","href":"https://www.unrealengine.com/previous-versions"},{"title":"Enterprise","href":"https://www.unrealengine.com/enterprise"}],"key":"about"},{"title":"Learn","useCustomCallback":false,"collapseTarget":"More","kids":[{"title":"Documentation","useCustomCallback":false,"href":"https://docs.unrealengine.com/"},{"title":"Video Tutorials","useCustomCallback":false,"href":"https://docs.unrealengine.com/latest/INT/Videos/"},{"title":"Wiki","useCustomCallback":false,"href":"https://wiki.unrealengine.com/Main_Page"}],"key":"learn"},{"title":"Community","useCustomCallback":false,"collapseTarget":"More","kids":[{"title":"Blog","href":"https://www.unrealengine.com/blog"},{"title":"Forums","useCustomCallback":false,"href":"https://forums.unrealengine.com/"},{"title":"AnswerHub","useCustomCallback":false,"href":"https://answers.unrealengine.com/"},{"title":"Roadmap","useCustomCallback":false,"href":"https://trello.com/b/gHooNW9I/ue4-roadmap"},{"title":"Unreal Dev Grants","href":"https://www.unrealengine.com/unrealdevgrants"},{"title":"Unreal Tournament","useCustomCallback":false,"href":"https://www.epicgames.com/unrealtournament/"}],"key":"community"},{"title":"Marketplace","useCustomCallback":false,"collapseTarget":"More","kids":[{"title":" Browse","href":"https://www.unrealengine.com/marketplace"},{"title":"Business Terms","useCustomCallback":false,"href":"https://publish.unrealengine.com/faq"},{"title":"Submission Guidelines","useCustomCallback":false,"href":"https://publish.unrealengine.com/submission-guidelines"},{"title":"Submit Your Content","useCustomCallback":false,"href":"https://publish.unrealengine.com/welcome"},{"title":"Marketplace Forums","useCustomCallback":false,"href":"https://forums.unrealengine.com/forumdisplay.php?56-Marketplace"}],"key":"marketplace"},{"title":"Academia","useCustomCallback":false,"collapseTarget":"More","kids":[{"title":"Education Program","href":"https://www.unrealengine.com/education"},{"title":"Academic Partners","href":"https://www.unrealengine.com/academic-partners"}],"key":"academia"}],"properties":[{"egSkip":false,"egDisabled":false,"propertyKey":"unreal_tournament","egHref":"https://www.epicgames.com/unrealtournament/"}],"epicPropertyName":"unreal_engine","pcDownloadUrl":"https://launcher-public-service-prod06.ol.epicgames.com/launcher/api/installer/download/EpicGamesLauncherInstaller.msi","hideLocale":true,"messages":{"sign_in":"Sign In","search":"Search","locale":"Locale","sign_out":"Sign Out","default_download":"Get Epic Games","default_username":"Account"},"logoLink":{"key":"logo","href":"https://www.unrealengine.com/blog"},"accountLinks":{"signOutLink":{"useCustomCallback":true,"key":"signout"},"signInLinks":[{"title":"Sign In","href":"https://www.unrealengine.com/login","key":"signin"}],"dropdownLinks":[{"title":"Personal","href":"https://www.unrealengine.com/dashboard","key":"personal"},{"title":"Seller","useCustomCallback":false,"href":"https://publish.unrealengine.com/","key":"seller"}]},"hideCallToAction":false,"downloadLink":{"useCustomCallback":false},"callToAction":{"title":"Get Unreal","useCustomCallback":true},"hideSignIn":false,"overrideParams":{"hideLocale":true,"useServerUrl":true},"locale":"en-US","serverUrl":"https://www.unrealengine.com","isLoggedIn":false}; })();
                    if (typeof window._epicGamesNav === 'undefined') {
                        window._epicGamesNav = config;
                    } else {
                        for (var key in config) {
                            if (typeof key === 'string') {
                                if (!window._epicGamesNav[key] && config[key] !== null) {
                                    window._epicGamesNav[key] = config[key];
                                }
                            }
                        }
                    }

                    /**
                     * For a documented example of what the config json object looks like:
                     *   /frontend/app/scripts/utils/epicGamesNavObserver.js
                     */
                })();
            
        </script>

        <div id="epicGamesNavigation" data-external="false"></div>

        
            <script src="https://cdn1.unrealengine.com/2957168/webpack/epicGamesHeader.epic-games-nav-f819007d594994f3801a875f6933a70c.js" type="text/javascript" ></script>
        
    </body>
</html>
        

        

        <div id="header" class="hidden" data-path="" data-sitepath="https://www.unrealengine.com">
            <input type="hidden" id="isUnified" value="1" />
            <input type="hidden" id="current_locale" value="en-US"/>
            <input type="hidden" id="header-host" value="https://www.unrealengine.com" />
            <input type="hidden" id="current_country" value="US"/>
        </div>
    </body>
</html>




		</div>
		<div id="pagedefault">		
                    <div id="pagenav">
                        <div>
                            <!-- Start of Other language links -->
                            <!-- End of Other language links -->
                            <div class="homelink_container">
                                <a href="https://wiki.unrealengine.com" title="UE4 Wiki Home" class="homelink">HOME</a>
                            </div>
                        </div>
                        <div style="clear:both;">
                        </div>
                    </div>	
		<div id="mw-navigation" style="max-width:972px;margin:1em auto 0 auto;">
			<h2>Navigation menu</h2>
			<div id="mw-head">
				<div id="jumplink" onclick="$('#sidebar').toggle();">
					Navigation
				</div>
				<div id="sidebar">
					<!-- Start of jump page links -->
					<div class="largetitle">
						Quick Links
					</div>
					<div class="arrowlist">
						<!-- End of jump page links -->
						<!-- Start of related page links -->
						<!-- End of related page links -->								
						<div id="mw-panel">
							<div class="portal" role="navigation" id='p-navigation' aria-labelledby='p-navigation-label'>
	<h3 id='p-navigation-label'>Navigation</h3>
	<div class="body">
		<ul>
			<li id="n-mainpage-description"><a href="/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
			<li id="n-recentchanges"><a href="/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
			<li id="n-randompage"><a href="/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id='p-Community' aria-labelledby='p-Community-label'>
	<h3 id='p-Community-label'>Community</h3>
	<div class="body">
		<ul>
			<li id="n-UE4-Games"><a href="/Category:Games">UE4 Games</a></li>
			<li id="n-Dev-Blogs"><a href="/Developer_Blogs">Dev Blogs</a></li>
			<li id="n-Dev-Livestreams"><a href="/Developer_Livestreams">Dev Livestreams</a></li>
			<li id="n-Code-Sharing-Hub"><a href="/GitHub_Sharing_Hub">Code Sharing Hub</a></li>
			<li id="n-UE-User-Groups"><a href="/User_Group_Map">UE User Groups</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id='p-Learning_Resources' aria-labelledby='p-Learning_Resources-label'>
	<h3 id='p-Learning_Resources-label'>Learning Resources</h3>
	<div class="body">
		<ul>
			<li id="n-Tutorials"><a href="/Category:Tutorials">Tutorials</a></li>
			<li id="n-Example-Projects"><a href="/Category:Example_Projects">Example Projects</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id='p-Software_and_Tools' aria-labelledby='p-Software_and_Tools-label'>
	<h3 id='p-Software_and_Tools-label'>Software and Tools</h3>
	<div class="body">
		<ul>
			<li id="n-Plug-ins"><a href="/Category:Plug-ins">Plug-ins</a></li>
			<li id="n-Art:-3D"><a href="/3D_Art_Resources">Art: 3D</a></li>
			<li id="n-Art:-2D"><a href="/2D_Art_Resources">Art: 2D</a></li>
			<li id="n-Audio"><a href="/Audio_Resources">Audio</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id='p-Modding' aria-labelledby='p-Modding-label'>
	<h3 id='p-Modding-label'>Modding</h3>
	<div class="body">
		<ul>
			<li id="n-Modding-Resources"><a href="/Category:Modding_Resources">Modding Resources</a></li>
			<li id="n-Moddable-Games"><a href="/Category:Moddable_Games">Moddable Games</a></li>
			<li id="n-Unreal-Tournament"><a href="/Category:Unreal_Tournament">Unreal Tournament</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id='p-Epic_Official' aria-labelledby='p-Epic_Official-label'>
	<h3 id='p-Epic_Official-label'>Epic Official</h3>
	<div class="body">
		<ul>
			<li id="n-Website"><a href="https://www.unrealengine.com" rel="nofollow">Website</a></li>
			<li id="n-Learning-Resources"><a href="https://docs.unrealengine.com/latest/INT/" rel="nofollow">Learning Resources</a></li>
			<li id="n-Forums"><a href="https://forums.unrealengine.com/" rel="nofollow">Forums</a></li>
			<li id="n-Blog"><a href="https://www.unrealengine.com/blog" rel="nofollow">Blog</a></li>
			<li id="n-YouTube"><a href="https://www.youtube.com/UnrealEngine" rel="nofollow">YouTube</a></li>
			<li id="n-Twitch"><a href="http://www.twitch.tv/unrealengine" rel="nofollow">Twitch</a></li>
			<li id="n-Twitter"><a href="https://twitter.com/UnrealEngine" rel="nofollow">Twitter</a></li>
			<li id="n-Facebook"><a href="https://www.facebook.com/UnrealEngine" rel="nofollow">Facebook</a></li>
			<li id="n-Instagram"><a href="https://instagram.com/unrealengine/" rel="nofollow">Instagram</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
	<h3 id='p-tb-label'>Tools</h3>
	<div class="body">
		<ul>
			<li id="t-whatlinkshere"><a href="/Special:WhatLinksHere/UT3_Weapons_Tutorial_-_Flak_Cannon" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
			<li id="t-recentchangeslinked"><a href="/Special:RecentChangesLinked/UT3_Weapons_Tutorial_-_Flak_Cannon" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
			<li id="t-specialpages"><a href="/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
			<li id="t-print"><a href="/index.php?title=UT3_Weapons_Tutorial_-_Flak_Cannon&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
			<li id="t-permalink"><a href="/index.php?title=UT3_Weapons_Tutorial_-_Flak_Cannon&amp;oldid=10610" title="Permanent link to this revision of the page">Permanent link</a></li>
			<li id="t-info"><a href="/index.php?title=UT3_Weapons_Tutorial_-_Flak_Cannon&amp;action=info">Page information</a></li>
		</ul>
	</div>
</div>
						</div>
					</div>
				</div>				
				<div id="left-navigation">
					<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
	<h3 id="p-namespaces-label">Namespaces</h3>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="/UT3_Weapons_Tutorial_-_Flak_Cannon"  title="View the content page [c]" accesskey="c">Page</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="/index.php?title=Talk:UT3_Weapons_Tutorial_-_Flak_Cannon&amp;action=edit&amp;redlink=1"  title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>
			</ul>
</div>
<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
	<h3 id="mw-vector-current-variant">
		</h3>
	<h3 id="p-variants-label"><span>Variants</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
				</div>
				<div id="right-navigation">
					<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
	<h3 id="p-views-label">Views</h3>
	<ul>
					<li id="ca-view" class="selected"><span><a href="/UT3_Weapons_Tutorial_-_Flak_Cannon" >View</a></span></li>
					<li id="ca-viewsource"><span><a href="/index.php?title=UT3_Weapons_Tutorial_-_Flak_Cannon&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
					<li id="ca-history" class="collapsible"><span><a href="/index.php?title=UT3_Weapons_Tutorial_-_Flak_Cannon&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">History</a></span></li>
			</ul>
</div>
<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
	<h3 id="p-cactions-label"><span>Actions</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
	<h3 id="p-personal-label">Personal tools</h3>
	<ul>
<li id="pt-createaccount"><a href="/index.php?title=Special:UserLogin&amp;returnto=UT3+Weapons+Tutorial+-+Flak+Cannon&amp;type=signup">Create account</a></li><li id="pt-login"><a href="/index.php?title=Special:UserLogin&amp;returnto=UT3+Weapons+Tutorial+-+Flak+Cannon" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>	</ul>
</div>
				</div>
			</div>
		</div>
		<div id="maincol">
		<div class="mw-body" role="main">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<!-- Start of crumbs links -->
			<div class="crumbs">
			<p>
							</p>
			</div>
			<!-- End of crumbs links -->
			<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">UT3 Weapons Tutorial - Flak Cannon</span></h1>
			<div id="bodyContent">
				<div id="contentSub"></div>
																<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#UT3_Weapons_Tutorial_-_Flak_Cannon"><span class="tocnumber">1</span> <span class="toctext">UT3 Weapons Tutorial - Flak Cannon</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Requirements"><span class="tocnumber">1.1</span> <span class="toctext">Requirements</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Features"><span class="tocnumber">1.2</span> <span class="toctext">Features</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Notes"><span class="tocnumber">1.3</span> <span class="toctext">Notes</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Contact"><span class="tocnumber">1.4</span> <span class="toctext">Contact</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Flak_Cannon"><span class="tocnumber">1.5</span> <span class="toctext">Flak Cannon</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="#Primary_Fire"><span class="tocnumber">1.5.1</span> <span class="toctext">Primary Fire</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Secondary_Fire"><span class="tocnumber">1.5.2</span> <span class="toctext">Secondary Fire</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#Shard_Projectile"><span class="tocnumber">1.5.3</span> <span class="toctext">Shard Projectile</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#Main_Shard_Projectile"><span class="tocnumber">1.5.4</span> <span class="toctext">Main Shard Projectile</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#Shell_Projectile"><span class="tocnumber">1.5.5</span> <span class="toctext">Shell Projectile</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-12"><a href="#Implementation"><span class="tocnumber">1.6</span> <span class="toctext">Implementation</span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="#Common_code"><span class="tocnumber">1.6.1</span> <span class="toctext">Common code</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#Creating_Flak_Cannon_Classes"><span class="tocnumber">1.6.2</span> <span class="toctext">Creating Flak Cannon Classes</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#Setting_up_weapon_asset_references"><span class="tocnumber">1.6.3</span> <span class="toctext">Setting up weapon asset references</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#Basic_Parameters"><span class="tocnumber">1.6.4</span> <span class="toctext">Basic Parameters</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#Playtesting"><span class="tocnumber">1.6.5</span> <span class="toctext">Playtesting</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#Adding_bounce_effects"><span class="tocnumber">1.6.6</span> <span class="toctext">Adding bounce effects</span></a>
<ul>
<li class="toclevel-4 tocsection-19"><a href="#Bounce_Effect_Rotation"><span class="tocnumber">1.6.6.1</span> <span class="toctext">Bounce Effect Rotation</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-20"><a href="#Making_projectile_become_affected_by_gravity_after_bounce"><span class="tocnumber">1.6.7</span> <span class="toctext">Making projectile become affected by gravity after bounce</span></a></li>
<li class="toclevel-3 tocsection-21"><a href="#Limiting_projectile_bounce_count"><span class="tocnumber">1.6.8</span> <span class="toctext">Limiting projectile bounce count</span></a></li>
<li class="toclevel-3 tocsection-22"><a href="#Increasing_projectile_lifespan_after_bounce"><span class="tocnumber">1.6.9</span> <span class="toctext">Increasing projectile lifespan after bounce</span></a></li>
<li class="toclevel-3 tocsection-23"><a href="#Reducing_projectile.27s_damage_over_time"><span class="tocnumber">1.6.10</span> <span class="toctext">Reducing projectile's damage over time</span></a></li>
<li class="toclevel-3 tocsection-24"><a href="#Making_projectile_apply_damage_only_when_moving_fast_enough"><span class="tocnumber">1.6.11</span> <span class="toctext">Making projectile apply damage only when moving fast enough</span></a></li>
<li class="toclevel-3 tocsection-25"><a href="#Flak_Cannon_main_shard"><span class="tocnumber">1.6.12</span> <span class="toctext">Flak Cannon main shard</span></a>
<ul>
<li class="toclevel-4 tocsection-26"><a href="#Adjusting_damage_based_on_how_much_in-the-face_the_shot_was"><span class="tocnumber">1.6.12.1</span> <span class="toctext">Adjusting damage based on how much in-the-face the shot was</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-27"><a href="#Making_Flak_Shell_spawn_additional_shards_on_explosion"><span class="tocnumber">1.6.13</span> <span class="toctext">Making Flak Shell spawn additional shards on explosion</span></a></li>
<li class="toclevel-3 tocsection-28"><a href="#Spawning_multiple_shards_at_once"><span class="tocnumber">1.6.14</span> <span class="toctext">Spawning multiple shards at once</span></a>
<ul>
<li class="toclevel-4 tocsection-29"><a href="#Projectile_firing_pattern"><span class="tocnumber">1.6.14.1</span> <span class="toctext">Projectile firing pattern</span></a>
<ul>
<li class="toclevel-5 tocsection-30"><a href="#Projectile_firing_pattern_randomization"><span class="tocnumber">1.6.14.1.1</span> <span class="toctext">Projectile firing pattern randomization</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-3 tocsection-31"><a href="#Camera_Shake"><span class="tocnumber">1.6.15</span> <span class="toctext">Camera Shake</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-32"><a href="#Source_Code"><span class="tocnumber">1.7</span> <span class="toctext">Source Code</span></a></li>
</ul>
</li>
</ul>
</div>

<h1><span class="mw-headline" id="UT3_Weapons_Tutorial_-_Flak_Cannon">UT3 Weapons Tutorial - Flak Cannon</span></h1>
<p>This tutorial will show you how to create Flak Cannon from Unreal Tournament 3 using C++ only.
</p><p>NOTE:
</p>
<ul>
<li> UT has just upgraded to UE 4.2.1, this tutorial will be verified for compatibility shortly.
</li>
</ul>
<p><br />
</p>
<h2><span class="mw-headline" id="Requirements">Requirements</span></h2>
<p>Some existing C++ &amp; Unreal Engine knowledge is needed.
</p>
<ul>
<li> Engine version: 4.2
</li>
<li> Skill level: intermediate
</li>
<li> Unreal Tournament commit: <a rel="nofollow" class="external text" href="https://github.com/EpicGames/UnrealTournament/commit/9fe9fc679a26a0ea816e9fd3db080255394bf4dc">9fe9fc679a26a0ea816e9fd3db080255394bf4dc</a>
</li>
</ul>
<p><br />
</p>
<h2><span class="mw-headline" id="Features">Features</span></h2>
<ul>
<li> Spawnng multiple projectiles at once
</li>
<li> Controlled firing pattern for multiple projectiles
</li>
<li> Making projectiles spawn other projectiles upon explosion
</li>
<li> Adjusting projectile damage based on distance and hit location
</li>
<li> Adjusting projectile damage over time
</li>
</ul>
<p><br />
</p>
<h2><span class="mw-headline" id="Notes">Notes</span></h2>
<ul>
<li> When overriding a function in subclass always add a definition to the header file as well.
</li>
<li> Functions with <a rel="nofollow" class="external text" href="https://docs.unrealengine.com/latest/INT/Programming/UnrealArchitecture/Reference/Functions/Specifiers/BlueprintNativeEvent/index.html">BlueprintNativeEvent</a> attribute generate additional virtual function called "FunctionName_Implementation". Override the _Implementation one instead.
</li>
<li> Code snippets are located in grey expandable boxes. Click Expand on the right to see the code.
</li>
<li> Yellow lines in code snippets highlight only the code that needs to be changed.
</li>
</ul>
<p><br />
</p>
<h2><span class="mw-headline" id="Contact">Contact</span></h2>
<ul>
<li> <a rel="nofollow" class="external text" href="https://forums.unrealtournament.com/showthread.php?11233-UT3-Flak-Cannon-Tutorial&amp;p=82857#post82857">unrealtournament.com forum thread</a> 
</li>
</ul>
<p>--<a href="/User:Neai" title="User:Neai">Neai</a> (<a href="/index.php?title=User_talk:Neai&amp;action=edit&amp;redlink=1" class="new" title="User talk:Neai (page does not exist)">talk</a>) 17:49, 30 June 2014 (UTC)
</p><p><br />
</p>
<h2><span class="mw-headline" id="Flak_Cannon">Flak Cannon</span></h2>
<p>We'll start by defining what features we want to implement:
</p>
<h3><span class="mw-headline" id="Primary_Fire">Primary Fire</span></h3>
<ol>
<li> Fire 9 shard projectiles at once
</li>
<li> Main shard should be fired at crosshair
</li>
<li> Remaining shards should be fired in a random'ish circle around the main shard
</li>
<li> The firing pattern should spread shards evenly inside the firing cone
</li>
</ol>
<h3><span class="mw-headline" id="Secondary_Fire">Secondary Fire</span></h3>
<ol>
<li> Fire an explosive shell projectile
</li>
</ol>
<h3><span class="mw-headline" id="Shard_Projectile">Shard Projectile</span></h3>
<ol>
<li> Bounces up to 2 times
</li>
<li> Is not affected by gravity until it bounces
</li>
<li> Can deal damage only when moving fast enough
</li>
</ol>
<h3><span class="mw-headline" id="Main_Shard_Projectile">Main Shard Projectile</span></h3>
<p>Same as shard projectile except that:
</p>
<ol>
<li> Bounces up to 3 times
</li>
<li> Deals additional damage &amp; momentum when firing at point blank at center of enemy 
</li>
</ol>
<h3><span class="mw-headline" id="Shell_Projectile">Shell Projectile</span></h3>
<ol>
<li> High trajectory
</li>
<li> Explodes upon contact
</li>
<li> Upon explosion spawns 5 shards
</li>
</ol>
<p><br />
</p>
<h2><span class="mw-headline" id="Implementation">Implementation</span></h2>
<p>To implement such projectile weapon we should create subclasses of <b>AUTWeapon</b>, <b>AUTProjectile</b>, <b>UUTDamageType</b> and <b>AUTWeaponAttachment</b>.
</p>
<h3><span class="mw-headline" id="Common_code">Common code</span></h3>
<p>We will implement some of the features in generic classes which can be later used for other weapons. To keep the tutorial code friendly to engine &amp; game code updates, we will create our own generic subclasses of UTWeapon &amp; UTProjectile instead of modifying them.
</p>
<div class="toccolours mw-collapsible">
<p>Lets start by creating an abstract subclass of <b>AUTWeapon</b> called <b>AUTWeapon_Boom</b>. This will be our common base class for UT3 weapons.
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="co1">// Copyright 1998-2014 Epic Games, Inc. All Rights Reserved.</span></pre></li><li class="li1"><pre class="de1"><span class="co2">#pragma once</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1"><span class="co2">#include &quot;UTWeapon.h&quot;</span></pre></li><li class="li2"><pre class="de2"><span class="co2">#include &quot;UTWeapon_Boom.generated.h&quot;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">UCLASS<span class="br0">&#40;</span>Abstract, NotPlaceable<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="kw2">class</span> AUTWeapon_Boom <span class="sy4">:</span> <span class="kw2">public</span> AUTWeapon</pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">	GENERATED_UCLASS_BODY<span class="br0">&#40;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible">
<p>We will also need an abstract subclass of <b>AUTProjectile</b> called <b>AUTProjectile_Boom</b>. This will be our common base class for UT3 projectiles.
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="co1">// Copyright 1998-2014 Epic Games, Inc. All Rights Reserved.</span></pre></li><li class="li1"><pre class="de1"><span class="co2">#pragma once</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1"><span class="co2">#include &quot;UTProjectile.h&quot;</span></pre></li><li class="li2"><pre class="de2"><span class="co2">#include &quot;UTProjectile_Boom.generated.h&quot;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">UCLASS<span class="br0">&#40;</span>Abstract, NotPlaceable<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="kw2">class</span> AUTProjectile_Boom <span class="sy4">:</span> <span class="kw2">public</span> AUTProjectile</pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">	GENERATED_UCLASS_BODY<span class="br0">&#40;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible">
<p>Since we are going to use property values from UT3, we will need to adjust them to UT4 player scale. In UT3 player is 88 units high, in UT4 player is 192 units high. Therefore we need to multiply all projectile velocities, damage radiuses, momentums, etc, to get the same results in UT4. Add the following definition to <b>UnrealTournament.h</b> so it's accessible from everywhere:
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="co1">// Ratio for scaling UT3 distance-related values</span></pre></li><li class="li1"><pre class="de1"><span class="co1">// See AUTCharacter CapsuleComponent HalfHeight</span></pre></li><li class="li1"><pre class="de1"><span class="co2">#define UT3_TO_UT4_SCALE (96.f / 44.f)</span></pre></li></ol></div></div>
</div>
</div>
<p><br />
</p>
<h3><span class="mw-headline" id="Creating_Flak_Cannon_Classes">Creating Flak Cannon Classes</span></h3>
<div class="toccolours mw-collapsible">
<p>Next, lets create classes for all the elements of Flak Cannon:
</p>
<div class="mw-collapsible-content">
<ol>
<li> Weapon
<ol>
<li> Create subclass of <b>AUTWeapon_Boom</b> called <b>AUTWeap_FlakCannon</b>
</li>
</ol>
</li>
<li> 3rd person weapon attachment
<ol>
<li> Create subclass of <b>AUTWeaponAttachment</b> called <b>AUTAttachment_FlakCannon</b>
</li>
</ol>
</li>
<li> Projectiles
<ol>
<li> Create subclass of <b>AUTProjectile_Boom</b> called <b>AUTProj_FlakShell</b>
</li>
<li> Create subclass of <b>AUTProjectile_Boom</b> called <b>AUTProj_FlakShard</b>
</li>
<li> Create subclass of <b>AUTProj_FlakShard</b> called <b>AUTProj_FlakShardMain</b>
</li>
</ol>
</li>
<li> Damage Types
<ol>
<li> Create subclass of <b>UUTDamageType</b> called <b>UTDmgType_FlakShell</b>
</li>
<li> Create subclass of <b>UUTDamageType</b> called <b>UTDmgType_FlakShard</b>
</li>
</ol>
</li>
</ol>
</div>
</div>
<p><br />
</p>
<h3><span class="mw-headline" id="Setting_up_weapon_asset_references">Setting up weapon asset references</span></h3>
<p>It's a good idea to have a functional weapon at the start, even if the custom logic isn't there yet. We will link all the parts together and assign visual properties. Assigning asset references to properties is very easy in blueprints, but we can do it in C++ as well.
</p>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTWeap_FlakCannon.cpp</b> - Setup asset references
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="co1">// Copyright 1998-2014 Epic Games, Inc. All Rights Reserved.</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1"><span class="co2">#include &quot;UnrealTournament.h&quot;</span></pre></li><li class="li1"><pre class="de1"><span class="co2">#include &quot;UTWeap_FlakCannon.h&quot;</span></pre></li><li class="li2"><pre class="de2"><span class="co2">#include &quot;UTProj_FlakShard.h&quot;</span></pre></li><li class="li1"><pre class="de1"><span class="co2">#include &quot;UTProj_FlakShell.h&quot;</span></pre></li><li class="li1"><pre class="de1"><span class="co2">#include &quot;UTProj_FlakShardMain.h&quot;</span></pre></li><li class="li1"><pre class="de1"><span class="co2">#include &quot;UTAttachment_FlakCannon.h&quot;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">AUTWeap_FlakCannon<span class="sy4">::</span><span class="me2">AUTWeap_FlakCannon</span><span class="br0">&#40;</span><span class="kw4">const</span> FPostConstructInitializeProperties<span class="sy3">&amp;</span> PCIP<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="sy4">:</span> Super<span class="br0">&#40;</span>PCIP<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span> </pre></li><li class="li1"><pre class="de1">	<span class="co1">// Asset references</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">struct</span> FConstructorStatics</pre></li><li class="li2"><pre class="de2">	<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>USkeletalMesh<span class="sy1">&gt;</span> SkeletalMesh<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>UAnimBlueprintGeneratedClass<span class="sy1">&gt;</span> AnimBlueprintGeneratedClass<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>UAnimMontage<span class="sy1">&gt;</span> FireAnimation0<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>UAnimMontage<span class="sy1">&gt;</span> FireAnimation1<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>UAnimMontage<span class="sy1">&gt;</span> BringUpAnim<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>UAnimMontage<span class="sy1">&gt;</span> PutDownAnim<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>USoundCue<span class="sy1">&gt;</span> FireSound0<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>USoundCue<span class="sy1">&gt;</span> FireSound1<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>USoundCue<span class="sy1">&gt;</span> PickupSound<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>UParticleSystem<span class="sy1">&gt;</span> MuzzleFlash<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		FConstructorStatics<span class="br0">&#40;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			<span class="sy4">:</span> SkeletalMesh<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;SkeletalMesh'/Game/RestrictedAssets/Proto/UT3_Weapons/WP_FlakCannon/Meshes/SK_WP_FlakCannon_1P.SK_WP_FlakCannon_1P'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			, AnimBlueprintGeneratedClass<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;AnimBlueprintGeneratedClass'/Game/RestrictedAssets/Proto/UT3_Weapons/WP_FlakCannon/Anim/Flak_AnimBP.Flak_AnimBP_C'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			, FireAnimation0<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;AnimMontage'/Game/RestrictedAssets/Proto/UT3_Weapons/WP_FlakCannon/Anim/Flak_Fire_Montage.Flak_Fire_Montage'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li2"><pre class="de2">			, FireAnimation1<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;AnimMontage'/Game/RestrictedAssets/Proto/UT3_Weapons/WP_FlakCannon/Anim/Flak_Fire_Montage.Flak_Fire_Montage'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			, BringUpAnim<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;AnimMontage'/Game/RestrictedAssets/Proto/UT3_Weapons/WP_FlakCannon/Anim/Flak_Equip.Flak_Equip'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			, PutDownAnim<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;AnimMontage'/Game/RestrictedAssets/Proto/UT3_Weapons/WP_FlakCannon/Anim/Flak_PutDown.Flak_PutDown'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			, FireSound0<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;SoundCue'/Game/RestrictedAssets/Proto/UT3_Weapons/WP_FlakCannon/Audio/CUE/A_FlakCannon_FireCue.A_FlakCannon_FireCue'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			, FireSound1<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;SoundCue'/Game/RestrictedAssets/Proto/UT3_Weapons/WP_FlakCannon/Audio/CUE/A_FlakCannon_FireAltCue.A_FlakCannon_FireAltCue'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li2"><pre class="de2">			, PickupSound<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;SoundCue'/Game/RestrictedAssets/Proto/UT3_Pickups/Audio/Weapons/Cue/A_Pickup_Weapons_Flak_Cue.A_Pickup_Weapons_Flak_Cue'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>MuzzleFlash<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;ParticleSystem'/Game/RestrictedAssets/Proto/UT3_Weapons/WP_FlakCannon/Effects/P_WP_FlakCannon_Muzzle_Flash.P_WP_FlakCannon_Muzzle_Flash'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">static</span> FConstructorStatics ConstructorStatics<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="co1">// Mesh</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	Mesh<span class="sy2">-</span><span class="sy1">&gt;</span>SkeletalMesh <span class="sy1">=</span> ConstructorStatics.<span class="me1">SkeletalMesh</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	Mesh<span class="sy2">-</span><span class="sy1">&gt;</span>AnimBlueprintGeneratedClass <span class="sy1">=</span> ConstructorStatics.<span class="me1">AnimBlueprintGeneratedClass</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	Mesh<span class="sy2">-</span><span class="sy1">&gt;</span>RelativeLocation <span class="sy1">=</span> FVector<span class="br0">&#40;</span><span class="sy2">-</span><span class="nu16">2.349056</span>, <span class="sy2">-</span><span class="nu16">3.957190</span>, <span class="sy2">-</span><span class="nu16">5.411549</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	Mesh<span class="sy2">-</span><span class="sy1">&gt;</span>RelativeScale3D <span class="sy1">=</span> FVector<span class="br0">&#40;</span><span class="nu16">0.750000</span>, <span class="nu16">0.750000</span>, <span class="nu16">0.750000</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	FireAnimation.<span class="me1">SetNumZeroed</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	FireAnimation<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="sy1">=</span> ConstructorStatics.<span class="me1">FireAnimation0</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	FireAnimation<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy1">=</span> ConstructorStatics.<span class="me1">FireAnimation1</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	BringUpAnim <span class="sy1">=</span> ConstructorStatics.<span class="me1">BringUpAnim</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	PutDownAnim <span class="sy1">=</span> ConstructorStatics.<span class="me1">PutDownAnim</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="co1">// Muzzle Flash</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	TSubobjectPtr<span class="sy1">&lt;</span>UParticleSystemComponent<span class="sy1">&gt;</span> MuzzleComponent <span class="sy1">=</span> PCIP.<span class="me1">CreateDefaultSubobject</span><span class="sy1">&lt;</span>UParticleSystemComponent<span class="sy1">&gt;</span><span class="br0">&#40;</span><span class="kw3">this</span>, TEXT<span class="br0">&#40;</span><span class="st0">&quot;FlakCannon-MuzzleFlash&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	MuzzleComponent<span class="sy2">-</span><span class="sy1">&gt;</span>Template <span class="sy1">=</span> ConstructorStatics.<span class="me1">MuzzleFlash</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	MuzzleComponent<span class="sy2">-</span><span class="sy1">&gt;</span>AttachTo<span class="br0">&#40;</span>Mesh, FName<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;MuzzleFlashSocket&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	MuzzleFlash.<span class="me1">SetNumZeroed</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	MuzzleFlash<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="sy1">=</span> MuzzleComponent<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	MuzzleFlash<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy1">=</span> MuzzleComponent<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="co1">// 3rd person</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	AttachmentType <span class="sy1">=</span> AUTAttachment_FlakCannon<span class="sy4">::</span><span class="me2">StaticClass</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="co1">// Sounds</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	FireSound.<span class="me1">SetNumZeroed</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	FireSound<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="sy1">=</span> ConstructorStatics.<span class="me1">FireSound0</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	FireSound<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy1">=</span> ConstructorStatics.<span class="me1">FireSound1</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	PickupSound <span class="sy1">=</span> ConstructorStatics.<span class="me1">PickupSound</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="co1">// UI</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	Group <span class="sy1">=</span> <span class="nu0">7</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	IconCoordinates <span class="sy1">=</span> FTextureUVs<span class="br0">&#40;</span><span class="nu16">131.000000</span>, <span class="nu16">429.000000</span>, <span class="nu16">132.000000</span>, <span class="nu16">52.000000</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
<p>Notice that assets are loaded statically only once. Asset paths can be copy-pasted straight from editor.
</p>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTAttachment_FlakCannon.cpp</b> - Setup asset references
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="co2">#include &quot;UnrealTournament.h&quot;</span></pre></li><li class="li1"><pre class="de1"><span class="co2">#include &quot;UTAttachment_FlakCannon.h&quot;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">AUTAttachment_FlakCannon<span class="sy4">::</span><span class="me2">AUTAttachment_FlakCannon</span><span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw2">class</span> FPostConstructInitializeProperties<span class="sy3">&amp;</span> PCIP<span class="br0">&#41;</span></pre></li><li class="li2"><pre class="de2">	<span class="sy4">:</span> Super<span class="br0">&#40;</span>PCIP<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	<span class="co1">// Structure to hold one-time initialization</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">struct</span> FConstructorStatics</pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>USkeletalMesh<span class="sy1">&gt;</span> SkeletalMesh<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		FConstructorStatics<span class="br0">&#40;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			<span class="sy4">:</span> SkeletalMesh<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;SkeletalMesh'/Game/RestrictedAssets/Proto/UT3_Weapons/WP_FlakCannon/Meshes/SK_WP_FlakCannon_3P_Mid.SK_WP_FlakCannon_3P_Mid'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#125;</span></pre></li><li class="li2"><pre class="de2">	<span class="br0">&#125;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">static</span> FConstructorStatics ConstructorStatics<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	Mesh<span class="sy2">-</span><span class="sy1">&gt;</span>SkeletalMesh <span class="sy1">=</span> ConstructorStatics.<span class="me1">SkeletalMesh</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShell.cpp</b> - Setup asset references
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="co2">#include &quot;UnrealTournament.h&quot;</span></pre></li><li class="li1"><pre class="de1"><span class="co2">#include &quot;UTProjectileMovementComponent.h&quot;</span></pre></li><li class="li1"><pre class="de1"><span class="co2">#include &quot;UTProj_FlakShell.h&quot;</span></pre></li><li class="li1"><pre class="de1"><span class="co2">#include &quot;UTProj_FlakShard.h&quot;</span></pre></li><li class="li2"><pre class="de2"><span class="co2">#include &quot;UTDmgType_FlakShell.h&quot;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">AUTProj_FlakShell<span class="sy4">::</span><span class="me2">AUTProj_FlakShell</span><span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw2">class</span> FPostConstructInitializeProperties<span class="sy3">&amp;</span> PCIP<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="sy4">:</span> Super<span class="br0">&#40;</span>PCIP<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">	<span class="co1">// Structure to hold one-time initialization</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">struct</span> FConstructorStatics</pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>UParticleSystem<span class="sy1">&gt;</span> ExplosionEffect<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>USoundCue<span class="sy1">&gt;</span> ExplosionSound<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>USoundCue<span class="sy1">&gt;</span> AmbientSound<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>UParticleSystem<span class="sy1">&gt;</span> TrailEffect<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		FConstructorStatics<span class="br0">&#40;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			<span class="sy4">:</span> ExplosionEffect<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;ParticleSystem'/Game/RestrictedAssets/Proto/UT3_Weapons/WP_FlakCannon/Effects/P_WP_Flak_Alt_Explosion.P_WP_Flak_Alt_Explosion'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			, ExplosionSound<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;SoundCue'/Game/RestrictedAssets/Proto/UT3_Weapons/WP_FlakCannon/Audio/CUE/A_FlakCannon_FireAltImpactExplodeCue.A_FlakCannon_FireAltImpactExplodeCue'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li2"><pre class="de2">			, AmbientSound<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;SoundCue'/Game/RestrictedAssets/Proto/UT3_Weapons/WP_FlakCannon/Audio/CUE/A_FlakCannon_FireAltInAirCue.A_FlakCannon_FireAltInAirCue'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			, TrailEffect<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;ParticleSystem'/Game/RestrictedAssets/Proto/UT3_Weapons/WP_FlakCannon/Effects/P_WP_Flak_Alt_Smoke_Trail.P_WP_Flak_Alt_Smoke_Trail'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	<span class="kw4">static</span> FConstructorStatics ConstructorStatics<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="co1">// Visuals</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	TSubobjectPtr<span class="sy1">&lt;</span>UAudioComponent<span class="sy1">&gt;</span> AmbientSound <span class="sy1">=</span> PCIP.<span class="me1">CreateDefaultSubobject</span><span class="sy1">&lt;</span>UAudioComponent<span class="sy1">&gt;</span><span class="br0">&#40;</span><span class="kw3">this</span>, TEXT<span class="br0">&#40;</span><span class="st0">&quot;FlakShell-Ambient&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	AmbientSound<span class="sy2">-</span><span class="sy1">&gt;</span>Sound <span class="sy1">=</span> ConstructorStatics.<span class="me1">AmbientSound</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	AmbientSound<span class="sy2">-</span><span class="sy1">&gt;</span>VolumeMultiplier <span class="sy1">=</span> <span class="nu16">0.5</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	AmbientSound<span class="sy2">-</span><span class="sy1">&gt;</span>AttachTo<span class="br0">&#40;</span>RootComponent<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	TSubobjectPtr<span class="sy1">&lt;</span>UParticleSystemComponent<span class="sy1">&gt;</span> TrailComponent <span class="sy1">=</span> PCIP.<span class="me1">CreateDefaultSubobject</span><span class="sy1">&lt;</span>UParticleSystemComponent<span class="sy1">&gt;</span><span class="br0">&#40;</span><span class="kw3">this</span>, TEXT<span class="br0">&#40;</span><span class="st0">&quot;FlakShell-Trail&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	TrailComponent<span class="sy2">-</span><span class="sy1">&gt;</span>Template <span class="sy1">=</span> ConstructorStatics.<span class="me1">TrailEffect</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	TrailComponent<span class="sy2">-</span><span class="sy1">&gt;</span>SetRelativeLocation<span class="br0">&#40;</span>FVector<span class="br0">&#40;</span><span class="sy2">-</span><span class="nu0">3</span>, <span class="nu0">0</span>, <span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	TrailComponent<span class="sy2">-</span><span class="sy1">&gt;</span>SetRelativeScale3D<span class="br0">&#40;</span>FVector<span class="br0">&#40;</span><span class="nu16">1.5</span>, <span class="nu16">1.5</span>, <span class="nu16">1.5</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	TrailComponent<span class="sy2">-</span><span class="sy1">&gt;</span>AttachTo<span class="br0">&#40;</span>RootComponent<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	TSubobjectPtr<span class="sy1">&lt;</span>UPointLightComponent<span class="sy1">&gt;</span> LightComponent <span class="sy1">=</span> PCIP.<span class="me1">CreateDefaultSubobject</span><span class="sy1">&lt;</span>UPointLightComponent<span class="sy1">&gt;</span><span class="br0">&#40;</span><span class="kw3">this</span>, TEXT<span class="br0">&#40;</span><span class="st0">&quot;FlakShell-Light&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	LightComponent<span class="sy2">-</span><span class="sy1">&gt;</span>Intensity <span class="sy1">=</span> <span class="nu0">150</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	LightComponent<span class="sy2">-</span><span class="sy1">&gt;</span>AttenuationRadius <span class="sy1">=</span> <span class="nu0">250</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	LightComponent<span class="sy2">-</span><span class="sy1">&gt;</span>LightColor <span class="sy1">=</span> FColor<span class="br0">&#40;</span><span class="nu0">47</span>, <span class="nu0">209</span>, <span class="nu0">255</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	LightComponent<span class="sy2">-</span><span class="sy1">&gt;</span>SetCastShadows<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	LightComponent<span class="sy2">-</span><span class="sy1">&gt;</span>AttachTo<span class="br0">&#40;</span>RootComponent<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	ExplosionEffect <span class="sy1">=</span> ConstructorStatics.<span class="me1">ExplosionEffect</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	ExplosionSound <span class="sy1">=</span> ConstructorStatics.<span class="me1">ExplosionSound</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
<p>The mesh is actually set up as part of particle emitter, hence there's no static mesh component.
</p>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShard.cpp</b> - Setup asset references
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="co2">#include &quot;UnrealTournament.h&quot;</span></pre></li><li class="li1"><pre class="de1"><span class="co2">#include &quot;UTProjectileMovementComponent.h&quot;</span></pre></li><li class="li1"><pre class="de1"><span class="co2">#include &quot;UTProj_FlakShard.h&quot;</span></pre></li><li class="li1"><pre class="de1"><span class="co2">#include &quot;UTDmgType_FlakShard.h&quot;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">AUTProj_FlakShard<span class="sy4">::</span><span class="me2">AUTProj_FlakShard</span><span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw2">class</span> FPostConstructInitializeProperties<span class="sy3">&amp;</span> PCIP<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="sy4">:</span> Super<span class="br0">&#40;</span>PCIP<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	<span class="co1">// Structure to hold one-time initialization</span></pre></li><li class="li2"><pre class="de2">	<span class="kw4">struct</span> FConstructorStatics</pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>UParticleSystem<span class="sy1">&gt;</span> BounceEffect<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>USoundCue<span class="sy1">&gt;</span> BounceSound<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>UStaticMesh<span class="sy1">&gt;</span> StaticMesh<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>UMaterial<span class="sy1">&gt;</span> StaticMeshMaterial0<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FObjectFinder</span><span class="sy1">&lt;</span>UParticleSystem<span class="sy1">&gt;</span> TrailEffect<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		FConstructorStatics<span class="br0">&#40;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			<span class="sy4">:</span> BounceEffect<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;ParticleSystem'/Game/RestrictedAssets/Weapons/Flak/Assets/Flak_Hit_Spark.Flak_Hit_Spark'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			, BounceSound<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;SoundCue'/Game/RestrictedAssets/Proto/UT3_Weapons/WP_FlakCannon/Audio/CUE/A_FlakCannon_FireImpactDirtCue.A_FlakCannon_FireImpactDirtCue'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li2"><pre class="de2">			, StaticMesh<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;StaticMesh'/Game/RestrictedAssets/Proto/UT3_Weapons/WP_FlakCannon/Meshes/S_Flak_Chunk.S_Flak_Chunk'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			, StaticMeshMaterial0<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;Material'/Game/RestrictedAssets/Weapons/Flak/Assets/M_Shard.M_Shard'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			, TrailEffect<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;ParticleSystem'/Game/RestrictedAssets/Weapons/Flak/Assets/Trail.Trail'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#125;</span></pre></li><li class="li2"><pre class="de2">	<span class="br0">&#125;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">static</span> FConstructorStatics ConstructorStatics<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="co1">// Visuals</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	TSubobjectPtr<span class="sy1">&lt;</span>UStaticMeshComponent<span class="sy1">&gt;</span> StaticMeshComponent <span class="sy1">=</span> PCIP.<span class="me1">CreateDefaultSubobject</span><span class="sy1">&lt;</span>UStaticMeshComponent<span class="sy1">&gt;</span><span class="br0">&#40;</span><span class="kw3">this</span>, TEXT<span class="br0">&#40;</span><span class="st0">&quot;FlakShard-StaticMesh&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	StaticMeshComponent<span class="sy2">-</span><span class="sy1">&gt;</span>StaticMesh <span class="sy1">=</span> ConstructorStatics.<span class="me1">StaticMesh</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	StaticMeshComponent<span class="sy2">-</span><span class="sy1">&gt;</span>bGenerateOverlapEvents <span class="sy1">=</span> <span class="kw2">false</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	StaticMeshComponent<span class="sy2">-</span><span class="sy1">&gt;</span>SetCollisionProfileName<span class="br0">&#40;</span>UCollisionProfile<span class="sy4">::</span><span class="me2">NoCollision_ProfileName</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	StaticMeshComponent<span class="sy2">-</span><span class="sy1">&gt;</span>SetMaterial<span class="br0">&#40;</span><span class="nu0">0</span>, ConstructorStatics.<span class="me1">StaticMeshMaterial0</span>.<span class="me1">Object</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	StaticMeshComponent<span class="sy2">-</span><span class="sy1">&gt;</span>SetRelativeScale3D<span class="br0">&#40;</span>FVector<span class="br0">&#40;</span><span class="nu16">0.25</span>, <span class="nu16">0.25</span>, <span class="nu16">0.25</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	StaticMeshComponent<span class="sy2">-</span><span class="sy1">&gt;</span>AttachTo<span class="br0">&#40;</span>RootComponent<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	TSubobjectPtr<span class="sy1">&lt;</span>UParticleSystemComponent<span class="sy1">&gt;</span> TrailComponent <span class="sy1">=</span> PCIP.<span class="me1">CreateDefaultSubobject</span><span class="sy1">&lt;</span>UParticleSystemComponent<span class="sy1">&gt;</span><span class="br0">&#40;</span><span class="kw3">this</span>, TEXT<span class="br0">&#40;</span><span class="st0">&quot;FlakShard-Trail&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	TrailComponent<span class="sy2">-</span><span class="sy1">&gt;</span>Template <span class="sy1">=</span> ConstructorStatics.<span class="me1">TrailEffect</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	TrailComponent<span class="sy2">-</span><span class="sy1">&gt;</span>AttachTo<span class="br0">&#40;</span>RootComponent<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	TSubobjectPtr<span class="sy1">&lt;</span>UPointLightComponent<span class="sy1">&gt;</span> LightComponent <span class="sy1">=</span> PCIP.<span class="me1">CreateDefaultSubobject</span><span class="sy1">&lt;</span>UPointLightComponent<span class="sy1">&gt;</span><span class="br0">&#40;</span><span class="kw3">this</span>, TEXT<span class="br0">&#40;</span><span class="st0">&quot;FlakShard-Light&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	LightComponent<span class="sy2">-</span><span class="sy1">&gt;</span>Intensity <span class="sy1">=</span> <span class="nu0">100</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	LightComponent<span class="sy2">-</span><span class="sy1">&gt;</span>AttenuationRadius <span class="sy1">=</span> <span class="nu0">100</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	LightComponent<span class="sy2">-</span><span class="sy1">&gt;</span>LightColor <span class="sy1">=</span> FColor<span class="br0">&#40;</span><span class="nu0">255</span>, <span class="nu0">133</span>, <span class="nu0">35</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	LightComponent<span class="sy2">-</span><span class="sy1">&gt;</span>SetCastShadows<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	LightComponent<span class="sy2">-</span><span class="sy1">&gt;</span>AttachTo<span class="br0">&#40;</span>RootComponent<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<p><br />
</p>
<h3><span class="mw-headline" id="Basic_Parameters">Basic Parameters</span></h3>
<p>We're going to use parameter values from UT3. Set them in constructors:
</p>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShell.cpp</b> - We will use high TossZ value to give the projectile high trajectory. This way player can aim at distant opponents without having to aim at the sky.
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	<span class="co1">// Movement</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	ProjectileMovement<span class="sy2">-</span><span class="sy1">&gt;</span>InitialSpeed <span class="sy1">=</span> <span class="nu0">1200</span>.<span class="me1">f</span> <span class="sy2">*</span> UT3_TO_UT4_SCALE<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	ProjectileMovement<span class="sy2">-</span><span class="sy1">&gt;</span>MaxSpeed <span class="sy1">=</span> <span class="nu0">1200</span>.<span class="me1">f</span> <span class="sy2">*</span> UT3_TO_UT4_SCALE<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	ProjectileMovement<span class="sy2">-</span><span class="sy1">&gt;</span>ProjectileGravityScale <span class="sy1">=</span> <span class="nu17">1.0f</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	CollisionComp<span class="sy2">-</span><span class="sy1">&gt;</span>InitSphereRadius<span class="br0">&#40;</span><span class="nu0">10</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	TossZ <span class="sy1">=</span> <span class="nu0">305</span> <span class="sy2">*</span> UT3_TO_UT4_SCALE<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="co1">// Damage</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	MyDamageType <span class="sy1">=</span> UUTDmgType_FlakShell<span class="sy4">::</span><span class="me2">StaticClass</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">	DamageParams.<span class="me1">BaseDamage</span> <span class="sy1">=</span> <span class="nu0">100</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	DamageParams.<span class="me1">OuterRadius</span> <span class="sy1">=</span> <span class="nu0">200</span> <span class="sy2">*</span> UT3_TO_UT4_SCALE<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	Momentum <span class="sy1">=</span> <span class="nu0">75000</span> <span class="sy2">*</span> UT3_TO_UT4_SCALE<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">	InitialLifeSpan <span class="sy1">=</span> <span class="nu0">6</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShard.cpp</b> - Lets make it rotate
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	<span class="co1">// Movement</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	TSubobjectPtr<span class="sy1">&lt;</span>URotatingMovementComponent<span class="sy1">&gt;</span> RotatingMovement <span class="sy1">=</span> PCIP.<span class="me1">CreateDefaultSubobject</span><span class="sy1">&lt;</span>URotatingMovementComponent<span class="sy1">&gt;</span><span class="br0">&#40;</span><span class="kw3">this</span>, TEXT<span class="br0">&#40;</span><span class="st0">&quot;FlakShard-RotatingMovement&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	RotatingMovement<span class="sy2">-</span><span class="sy1">&gt;</span>RotationRate <span class="sy1">=</span> FRotator<span class="br0">&#40;</span><span class="nu0">0</span>, <span class="nu0">0</span>, <span class="nu0">270</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">	ProjectileMovement<span class="sy2">-</span><span class="sy1">&gt;</span>InitialSpeed <span class="sy1">=</span> <span class="nu0">3500</span>.<span class="me1">f</span> <span class="sy2">*</span> UT3_TO_UT4_SCALE<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	ProjectileMovement<span class="sy2">-</span><span class="sy1">&gt;</span>MaxSpeed <span class="sy1">=</span> <span class="nu0">3500</span>.<span class="me1">f</span> <span class="sy2">*</span> UT3_TO_UT4_SCALE<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	ProjectileMovement<span class="sy2">-</span><span class="sy1">&gt;</span>ProjectileGravityScale <span class="sy1">=</span> <span class="nu0">0</span>.<span class="me1">f</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	ProjectileMovement<span class="sy2">-</span><span class="sy1">&gt;</span>bRotationFollowsVelocity <span class="sy1">=</span> <span class="kw2">false</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	ProjectileMovement<span class="sy2">-</span><span class="sy1">&gt;</span>bShouldBounce <span class="sy1">=</span> <span class="kw2">true</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="co1">// Damage</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	MyDamageType <span class="sy1">=</span> UUTDmgType_FlakShard<span class="sy4">::</span><span class="me2">StaticClass</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	DamageParams.<span class="me1">BaseDamage</span> <span class="sy1">=</span> <span class="nu0">18</span>.<span class="me1">f</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	Momentum <span class="sy1">=</span> <span class="nu0">14000</span> <span class="sy2">*</span> UT3_TO_UT4_SCALE<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	InitialLifeSpan <span class="sy1">=</span> <span class="nu0">2</span>.<span class="me1">f</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTWeap_FlakCannon.cpp</b> - Setting up fire modes
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	<span class="co1">// Firing</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	ProjClass.<span class="me1">SetNumZeroed</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	ProjClass<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="sy1">=</span> AUTProj_FlakShardMain<span class="sy4">::</span><span class="me2">StaticClass</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	ProjClass<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy1">=</span> AUTProj_FlakShell<span class="sy4">::</span><span class="me2">StaticClass</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	FireInterval.<span class="me1">SetNumZeroed</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	FireInterval<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="sy1">=</span> <span class="nu16">1.1</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	FireInterval<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy1">=</span> <span class="nu16">1.1</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">	AmmoCost.<span class="me1">SetNumZeroed</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	AmmoCost<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="sy1">=</span> <span class="nu0">1</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	AmmoCost<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy1">=</span> <span class="nu0">1</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	Ammo <span class="sy1">=</span> <span class="nu0">10</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	MaxAmmo <span class="sy1">=</span> <span class="nu0">30</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	FireOffset <span class="sy1">=</span> FVector<span class="br0">&#40;</span><span class="nu0">75</span>.<span class="me1">f</span>, <span class="nu0">18</span>.<span class="me1">f</span>, <span class="sy2">-</span><span class="nu0">15</span>.<span class="me1">f</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<p><br />
</p>
<h3><span class="mw-headline" id="Playtesting">Playtesting</span></h3>
<p>At this point we can test the weapon ingame, although it doesn't have custom logic yet. To test the weapon add an <b>WeaponBase</b> Blueprint to level and in its properties make it use our <b>AUTWeap_FlakCannon</b>.
</p><p><br />
</p>
<h3><span class="mw-headline" id="Adding_bounce_effects">Adding bounce effects</span></h3>
<div class="toccolours mw-collapsible">
<p><b>AUTProjectile_Boom.h</b> - Add properties for Bounce Effect assets
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	<span class="coMULTI">/** Bounce effect */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> Projectile<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	UParticleSystem<span class="sy2">*</span> BounceEffect<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	<span class="coMULTI">/** Sound played when projectile bounces off wall */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> Projectile<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	USoundBase<span class="sy2">*</span> BounceSound<span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProjectile_Boom.cpp</b> - Override OnBounce to make it play bounce effects
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="kw4">void</span> AUTProjectile_Boom<span class="sy4">::</span><span class="me2">OnBounce</span><span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw4">struct</span> FHitResult<span class="sy3">&amp;</span> ImpactResult, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> ImpactVelocity<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	Super<span class="sy4">::</span><span class="me2">OnBounce</span><span class="br0">&#40;</span>ImpactResult, ImpactVelocity<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	<span class="co1">// Spawn bounce effect</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span>GetNetMode<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy3">!</span><span class="sy1">=</span> NM_DedicatedServer<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		UGameplayStatics<span class="sy4">::</span><span class="me2">SpawnEmitterAtLocation</span><span class="br0">&#40;</span>GetWorld<span class="br0">&#40;</span><span class="br0">&#41;</span>, BounceEffect, ImpactResult.<span class="me1">Location</span>, ImpactResult.<span class="me1">ImpactNormal</span>.<span class="me1">Rotation</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, <span class="kw2">true</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="co1">// Play bounce sound</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span>BounceSound <span class="sy3">!</span><span class="sy1">=</span> <span class="kw2">NULL</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		UUTGameplayStatics<span class="sy4">::</span><span class="me2">UTPlaySound</span><span class="br0">&#40;</span>GetWorld<span class="br0">&#40;</span><span class="br0">&#41;</span>, BounceSound, <span class="kw3">this</span>, SRT_IfSourceNotReplicated, <span class="kw2">false</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShard.cpp</b> - Add default assets to constructor
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	BounceEffect <span class="sy1">=</span> ConstructorStatics.<span class="me1">BounceEffect</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	BounceSound <span class="sy1">=</span> ConstructorStatics.<span class="me1">BounceSound</span>.<span class="me1">Object</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<p>After those changes, shards will spark on bounce and play sound effect.
</p><p><br />
</p>
<h4><span class="mw-headline" id="Bounce_Effect_Rotation">Bounce Effect Rotation</span></h4>
<p>Notice that the sparks asset used will spawn in incorrect direction. This is because we're spawning in HitNormal direction, which has X axis pointing away from surface, and the emitter is spawning projectiles in Z axis direction, which in this case will be parallel to floor. The correct fix is to adjust the emitter asset so it spawns in X direction. We can however add a temporary workaround.
</p>
<div class="toccolours mw-collapsible">
<p><b>AUTProjectile_Boom.h</b> - Lets add a BounceEffectRotation property
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	<span class="coMULTI">/** Bounce effect */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> Projectile<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	FRotator BounceEffectRotation<span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProjectile_Boom.cpp</b> - We will use it to rotate HitNormal used for BounceEffect spawn rotation
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="kw4">void</span> AUTProjectile_Boom<span class="sy4">::</span><span class="me2">OnBounce</span><span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw4">struct</span> FHitResult<span class="sy3">&amp;</span> ImpactResult, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> ImpactVelocity<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	Super<span class="sy4">::</span><span class="me2">OnBounce</span><span class="br0">&#40;</span>ImpactResult, ImpactVelocity<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	<span class="co1">// Spawn bounce effect</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span>GetNetMode<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy3">!</span><span class="sy1">=</span> NM_DedicatedServer<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">		UGameplayStatics<span class="sy4">::</span><span class="me2">SpawnEmitterAtLocation</span><span class="br0">&#40;</span>GetWorld<span class="br0">&#40;</span><span class="br0">&#41;</span>, BounceEffect, ImpactResult.<span class="me1">Location</span>, BounceEffectRotation.<span class="me1">RotateVector</span><span class="br0">&#40;</span>ImpactResult.<span class="me1">ImpactNormal</span><span class="br0">&#41;</span>.<span class="me1">Rotation</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, <span class="kw2">true</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="co1">// Play bounce sound</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span>BounceSound <span class="sy3">!</span><span class="sy1">=</span> <span class="kw2">NULL</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		UUTGameplayStatics<span class="sy4">::</span><span class="me2">UTPlaySound</span><span class="br0">&#40;</span>GetWorld<span class="br0">&#40;</span><span class="br0">&#41;</span>, BounceSound, <span class="kw3">this</span>, SRT_IfSourceNotReplicated, <span class="kw2">false</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	<span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShard.cpp</b> - Set default BounceEffectRotation in constructor
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	BounceEffectRotation <span class="sy1">=</span> FRotator<span class="br0">&#40;</span><span class="nu0">90</span>, <span class="nu0">0</span>, <span class="nu0">0</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<p><br />
</p>
<h3><span class="mw-headline" id="Making_projectile_become_affected_by_gravity_after_bounce">Making projectile become affected by gravity after bounce</span></h3>
<p>We want the shards to fly unaffected by gravity initially. Only after bounce they should fall towards floor.
</p>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShard.cpp</b> - To do so, lets override OnBounce
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="kw4">void</span> AUTProj_FlakShard<span class="sy4">::</span><span class="me2">OnBounce</span><span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw4">struct</span> FHitResult<span class="sy3">&amp;</span> ImpactResult, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> ImpactVelocity<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	Super<span class="sy4">::</span><span class="me2">OnBounce</span><span class="br0">&#40;</span>ImpactResult, ImpactVelocity<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	<span class="co1">// Set gravity on bounce</span></pre></li><li class="li1"><pre class="de1">	ProjectileMovement<span class="sy2">-</span><span class="sy1">&gt;</span>ProjectileGravityScale <span class="sy1">=</span> <span class="nu0">1</span>.<span class="me1">f</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<p><br />
</p>
<h3><span class="mw-headline" id="Limiting_projectile_bounce_count">Limiting projectile bounce count</span></h3>
<p>Next we will limit number of bounces to 2, as this is how UT3 Flak Shards work.
</p>
<div class="toccolours mw-collapsible">
<p><b>AUTProj_FlakShard.h</b> - Add 2 new properties to define max number of bounces and current number of bounces
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	<span class="coMULTI">/** Limit number of bounces */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Flak Cannon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">int32</span> BounceLimit<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	<span class="coMULTI">/** Current number of times this projectile bounced */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Flak Cannon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">int32</span> BounceCount<span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShard.cpp</b> - Set default number of bounces in constructor
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	BounceLimit <span class="sy1">=</span> <span class="nu0">2</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShard.cpp</b> - Count the number of bounces in OnBounce and disable bouncing once limit is reached
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="kw4">void</span> AUTProj_FlakShard<span class="sy4">::</span><span class="me2">OnBounce</span><span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw4">struct</span> FHitResult<span class="sy3">&amp;</span> ImpactResult, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> ImpactVelocity<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	Super<span class="sy4">::</span><span class="me2">OnBounce</span><span class="br0">&#40;</span>ImpactResult, ImpactVelocity<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	<span class="co1">// Set gravity on bounce</span></pre></li><li class="li1"><pre class="de1">	ProjectileMovement<span class="sy2">-</span><span class="sy1">&gt;</span>ProjectileGravityScale <span class="sy1">=</span> <span class="nu0">1</span>.<span class="me1">f</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1 ln-xtra"><pre class="de1">	<span class="co1">// Limit number of bounces</span></pre></li><li class="li1 ln-xtra"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy2">++</span>BounceCount <span class="sy1">==</span> BounceLimit<span class="br0">&#41;</span></pre></li><li class="li2 ln-xtra"><pre class="de2">	<span class="br0">&#123;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">		ProjectileMovement<span class="sy2">-</span><span class="sy1">&gt;</span>bShouldBounce <span class="sy1">=</span> <span class="kw2">false</span><span class="sy4">;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<p><br />
</p>
<h3><span class="mw-headline" id="Increasing_projectile_lifespan_after_bounce">Increasing projectile lifespan after bounce</span></h3>
<p>We want to ensure that shards will fly for a bit after bouncing. Each projectile has a InitialLifeSpan property set that will limit how long this projectile can exist. Combined with velocity it affects maximum shooting distance.
</p>
<div class="toccolours mw-collapsible">
<p><b>AUTProj_FlakShard.h</b> - Add 2 new properties for increasing lifespan after bounce and an extra one after final bounce
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	<span class="coMULTI">/** Increment lifespan on bounce by this amount */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Flak Cannon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">float</span> BounceLifeSpanIncrement<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	<span class="coMULTI">/** Increment lifespan when projectile stops by this amount */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Flak Cannon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">float</span> BounceFinalLifeSpanIncrement<span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShard.cpp</b> - Set default values for bonus lifespan
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	BounceLifeSpanIncrement <span class="sy1">=</span> <span class="nu17">0.5f</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	BounceFinalLifeSpanIncrement <span class="sy1">=</span> <span class="nu17">0.25f</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShard.cpp</b> - Count the number of bounces in OnBounce and disable bouncing once limit is reached
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="kw4">void</span> AUTProj_FlakShard<span class="sy4">::</span><span class="me2">OnBounce</span><span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw4">struct</span> FHitResult<span class="sy3">&amp;</span> ImpactResult, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> ImpactVelocity<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	Super<span class="sy4">::</span><span class="me2">OnBounce</span><span class="br0">&#40;</span>ImpactResult, ImpactVelocity<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	<span class="co1">// Set gravity on bounce</span></pre></li><li class="li1"><pre class="de1">	ProjectileMovement<span class="sy2">-</span><span class="sy1">&gt;</span>ProjectileGravityScale <span class="sy1">=</span> <span class="nu0">1</span>.<span class="me1">f</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1 ln-xtra"><pre class="de1">	<span class="co1">// Extend lifespan on bounce</span></pre></li><li class="li1 ln-xtra"><pre class="de1">	SetLifeSpan<span class="br0">&#40;</span>GetLifeSpan<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy2">+</span> BounceLifeSpanIncrement<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="co1">// Limit number of bounces</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy2">++</span>BounceCount <span class="sy1">==</span> BounceLimit<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		ProjectileMovement<span class="sy2">-</span><span class="sy1">&gt;</span>bShouldBounce <span class="sy1">=</span> <span class="kw2">false</span><span class="sy4">;</span></pre></li><li class="li2 ln-xtra"><pre class="de2">		SetLifeSpan<span class="br0">&#40;</span>GetLifeSpan<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy2">+</span> BounceFinalLifeSpanIncrement<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<p><br />
</p>
<h3><span class="mw-headline" id="Reducing_projectile.27s_damage_over_time">Reducing projectile's damage over time</span></h3>
<p>Flak Shards lose 5 damage per second of flight. To implement that we'll need to add function that calculate actual damage instead of using only properties. While we're at it, we'll add dynamic momentum calculation as well, which will come handy later.
</p>
<div class="toccolours mw-collapsible">
<p><b>AUTProjectile_Boom.h</b> - Add DamageAttenuation property that will deteermine amount of damage lost per second, and 2 new functions.
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	<span class="coMULTI">/** Damage reduction per second, down to minimum damage*/</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> Damage<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">float</span> DamageAttenuation<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	<span class="coMULTI">/** Base damage calculation */</span></pre></li><li class="li1"><pre class="de1">	UFUNCTION<span class="br0">&#40;</span>BlueprintCallable, Category <span class="sy1">=</span> Projectile<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw2">virtual</span> <span class="kw4">float</span> GetDamage<span class="br0">&#40;</span>AActor<span class="sy2">*</span> OtherActor, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> HitLocation<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="coMULTI">/** Momentum calculation */</span></pre></li><li class="li2"><pre class="de2">	UFUNCTION<span class="br0">&#40;</span>BlueprintCallable, Category <span class="sy1">=</span> Projectile<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw2">virtual</span> <span class="kw4">float</span> GetMomentum<span class="br0">&#40;</span>AActor<span class="sy2">*</span> OtherActor, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> HitLocation<span class="br0">&#41;</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProjectile_Boom.cpp</b> - If DamageAttenuation is set, GetDamage() will return reduced damage.
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="kw4">float</span> AUTProjectile_Boom<span class="sy4">::</span><span class="me2">GetDamage</span><span class="br0">&#40;</span>AActor<span class="sy2">*</span> OtherActor, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> HitLocation<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span>DamageAttenuation <span class="sy1">&gt;</span> <span class="nu0">0</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">		<span class="kw1">return</span> FMath<span class="sy4">::</span><span class="me2">Max</span><span class="br0">&#40;</span>DamageParams.<span class="me1">BaseDamage</span> <span class="sy2">-</span> <span class="br0">&#40;</span>GetWorld<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy2">-</span><span class="sy1">&gt;</span>TimeSeconds <span class="sy2">-</span> CreationTime<span class="br0">&#41;</span> <span class="sy2">*</span> DamageAttenuation, DamageParams.<span class="me1">MinimumDamage</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">return</span> DamageParams.<span class="me1">BaseDamage</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProjectile_Boom.cpp</b> - GetMomentum() will return standard momentum by default.
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="kw4">float</span> AUTProjectile_Boom<span class="sy4">::</span><span class="me2">GetMomentum</span><span class="br0">&#40;</span>AActor<span class="sy2">*</span> OtherActor, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> HitLocation<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">return</span> Momentum<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProjectile_Boom.cpp</b> - To adjust damage &amp; momentum of explosions, override Explode_Implementation(). 
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="kw4">void</span> AUTProjectile_Boom<span class="sy4">::</span><span class="me2">Explode_Implementation</span><span class="br0">&#40;</span><span class="kw4">const</span> FVector<span class="sy3">&amp;</span> HitLocation, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> HitNormal<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy3">!</span>bExploded<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">		<span class="kw1">if</span> <span class="br0">&#40;</span>DamageParams.<span class="me1">OuterRadius</span> <span class="sy1">&gt;</span> <span class="nu17">0.0f</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">			TArray<span class="sy1">&lt;</span>AActor<span class="sy2">*</span><span class="sy1">&gt;</span> IgnoreActors<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">			<span class="kw1">if</span> <span class="br0">&#40;</span>ImpactedActor <span class="sy3">!</span><span class="sy1">=</span> <span class="kw2">NULL</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			<span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">				IgnoreActors.<span class="me1">Add</span><span class="br0">&#40;</span>ImpactedActor<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">			<span class="br0">&#125;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">			<span class="kw4">const</span> <span class="kw4">float</span> AdjustedDamage <span class="sy1">=</span> GetDamage<span class="br0">&#40;</span><span class="kw2">NULL</span>, HitLocation<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">			<span class="kw4">const</span> <span class="kw4">float</span> AdjustedMomentum <span class="sy1">=</span> GetMomentum<span class="br0">&#40;</span><span class="kw2">NULL</span>, HitLocation<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">			UUTGameplayStatics<span class="sy4">::</span><span class="me2">UTHurtRadius</span><span class="br0">&#40;</span><span class="kw3">this</span>, AdjustedDamage, DamageParams.<span class="me1">MinimumDamage</span>, AdjustedMomentum, HitLocation, DamageParams.<span class="me1">InnerRadius</span>, DamageParams.<span class="me1">OuterRadius</span>, DamageParams.<span class="me1">DamageFalloff</span>, MyDamageType, IgnoreActors, <span class="kw3">this</span>, InstigatorController<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">		<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw1">if</span> <span class="br0">&#40;</span>Role <span class="sy1">==</span> ROLE_Authority<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">			bTearOff <span class="sy1">=</span> <span class="kw2">true</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#125;</span></pre></li><li class="li2"><pre class="de2">		bExploded <span class="sy1">=</span> <span class="kw2">true</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		UUTGameplayStatics<span class="sy4">::</span><span class="me2">UTPlaySound</span><span class="br0">&#40;</span>GetWorld<span class="br0">&#40;</span><span class="br0">&#41;</span>, ExplosionSound, <span class="kw3">this</span>, ESoundReplicationType<span class="sy4">::</span><span class="me2">SRT_IfSourceNotReplicated</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw1">if</span> <span class="br0">&#40;</span>GetNetMode<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy3">!</span><span class="sy1">=</span> NM_DedicatedServer<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">			UGameplayStatics<span class="sy4">::</span><span class="me2">SpawnEmitterAtLocation</span><span class="br0">&#40;</span>GetWorld<span class="br0">&#40;</span><span class="br0">&#41;</span>, ExplosionEffect, GetActorLocation<span class="br0">&#40;</span><span class="br0">&#41;</span>, HitNormal.<span class="me1">Rotation</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, <span class="kw2">true</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">		<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">		ShutDown<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
<p>In current version of UT we had to copy paste entire function from AUT_projectile, as applying radius damage is not split into own function yet.
</p>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTWeapon_Boom.cpp</b> - To adjust damage &amp; momentum of direct damage, override DamageImpactedActor_Implementation
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="kw4">void</span> AUTProjectile_Boom<span class="sy4">::</span><span class="me2">DamageImpactedActor_Implementation</span><span class="br0">&#40;</span>AActor<span class="sy2">*</span> OtherActor, UPrimitiveComponent<span class="sy2">*</span> OtherComp, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> HitLocation, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> HitNormal<span class="br0">&#41;</span></pre></li><li class="li1 ln-xtra"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">	<span class="kw4">const</span> <span class="kw4">float</span> AdjustedDamage <span class="sy1">=</span> GetDamage<span class="br0">&#40;</span>OtherActor, HitLocation<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">	<span class="kw4">const</span> <span class="kw4">float</span> AdjustedMomentum <span class="sy1">=</span> GetMomentum<span class="br0">&#40;</span>OtherActor, HitLocation<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	<span class="co1">// treat as point damage if projectile has no radius</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span>DamageParams.<span class="me1">OuterRadius</span> <span class="sy1">&gt;</span> <span class="nu17">0.0f</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		FUTRadialDamageEvent Event<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		Event.<span class="me1">Params</span> <span class="sy1">=</span> DamageParams<span class="sy4">;</span></pre></li><li class="li2 ln-xtra"><pre class="de2">		Event.<span class="me1">Params</span>.<span class="me1">MinimumDamage</span> <span class="sy1">=</span> AdjustedDamage<span class="sy4">;</span> <span class="co1">// force full damage for direct hit</span></pre></li><li class="li1"><pre class="de1">		Event.<span class="me1">DamageTypeClass</span> <span class="sy1">=</span> MyDamageType<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		Event.<span class="me1">Origin</span> <span class="sy1">=</span> HitLocation<span class="sy4">;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">		Event.<span class="me1">BaseMomentumMag</span> <span class="sy1">=</span> AdjustedMomentum<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw3">new</span><span class="br0">&#40;</span>Event.<span class="me1">ComponentHits</span><span class="br0">&#41;</span> FHitResult<span class="br0">&#40;</span>OtherActor, OtherComp, HitLocation, HitNormal<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">		Event.<span class="me1">ComponentHits</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>.<span class="me1">TraceStart</span> <span class="sy1">=</span> HitLocation <span class="sy2">-</span> GetVelocity<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		Event.<span class="me1">ComponentHits</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>.<span class="me1">TraceEnd</span> <span class="sy1">=</span> HitLocation <span class="sy2">+</span> GetVelocity<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">		OtherActor<span class="sy2">-</span><span class="sy1">&gt;</span>TakeDamage<span class="br0">&#40;</span>AdjustedDamage, Event, InstigatorController, <span class="kw3">this</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">else</span></pre></li><li class="li2"><pre class="de2">	<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		FUTPointDamageEvent Event<span class="sy4">;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">		Event.<span class="me1">Damage</span> <span class="sy1">=</span> AdjustedDamage<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		Event.<span class="me1">DamageTypeClass</span> <span class="sy1">=</span> MyDamageType<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		Event.<span class="me1">HitInfo</span> <span class="sy1">=</span> FHitResult<span class="br0">&#40;</span>OtherActor, OtherComp, HitLocation, HitNormal<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">		Event.<span class="me1">ShotDirection</span> <span class="sy1">=</span> GetVelocity<span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">SafeNormal</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">		Event.<span class="me1">Momentum</span> <span class="sy1">=</span> Event.<span class="me1">ShotDirection</span> <span class="sy2">*</span> AdjustedMomentum<span class="sy4">;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">		OtherActor<span class="sy2">-</span><span class="sy1">&gt;</span>TakeDamage<span class="br0">&#40;</span>AdjustedDamage, Event, InstigatorController, <span class="kw3">this</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShard.cpp</b> - Finally set default DamageAttentuation in Flak Shard constructor
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	DamageAttenuation <span class="sy1">=</span> <span class="nu0">5</span>.<span class="me1">f</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<p><br />
</p>
<h3><span class="mw-headline" id="Making_projectile_apply_damage_only_when_moving_fast_enough">Making projectile apply damage only when moving fast enough</span></h3>
<p>Flak Shards deal damage only when moving over 400 UU/s. This way shards that lost much of the velocity after bounce won't hit you.
</p>
<div class="toccolours mw-collapsible">
<p><b>AUTProj_FlakShard.h</b> - Add MinDamageSpeed property to determine minimum speed required to apply damage.
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	<span class="coMULTI">/** Minimum speed at which damage can be applied */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Flak Cannon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">float</span> MinDamageSpeed<span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShard.cpp</b> - Set default MinDamageSpeed in FlakShard constructor.
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	MinDamageSpeed <span class="sy1">=</span> <span class="nu0">400</span>.<span class="me1">f</span> <span class="sy2">*</span> UT3_TO_UT4_SCALE<span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShard.cpp</b> - With our custom GetDamage() function in place, override it in FlakShard to adjust its damage.
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="kw4">float</span> AUTProj_FlakShard<span class="sy4">::</span><span class="me2">GetDamage</span><span class="br0">&#40;</span>AActor<span class="sy2">*</span> OtherActor, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> HitLocation<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	<span class="co1">// Apply damage only when moving fast enough</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span>GetVelocity<span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">Size</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy1">&gt;</span> MinDamageSpeed<span class="br0">&#41;</span></pre></li><li class="li2"><pre class="de2">	<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw1">return</span> Super<span class="sy4">::</span><span class="me2">GetDamage</span><span class="br0">&#40;</span>OtherActor, HitLocation<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">return</span> <span class="nu0">0</span>.<span class="me1">f</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<p><br />
</p>
<h3><span class="mw-headline" id="Flak_Cannon_main_shard">Flak Cannon main shard</span></h3>
<p>Flak Cannon fires a special shard at the center. It always fires at crosshair, can bounce 3 times and deals additional damage at close range.
</p>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShardMain.cpp</b> - Increase BounceLimit to 3 in FlakShardMain constructor.
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	BounceLimit <span class="sy1">=</span> <span class="nu0">3</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<p><br />
</p>
<h4><span class="mw-headline" id="Adjusting_damage_based_on_how_much_in-the-face_the_shot_was">Adjusting damage based on how much in-the-face the shot was</span></h4>
<p>Main Flak Shard deals bonus damage at very close range. Additionally it deals more damage when aiming at center of enemy.
</p>
<div class="toccolours mw-collapsible">
<p><b>AUTProj_FlakShardMain.h</b> - Add properties for bonus damage and momentum. To check how far the projectile travelled we will use the same method as in UT3 - checking elapsed  LifeSpan
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	<span class="coMULTI">/** Momentum bonus for point blank shots */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Flak Cannon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">float</span> CenteredMomentumBonus<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	<span class="coMULTI">/** Damage bonus for point blank shots */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Flak Cannon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">float</span> CenteredDamageBonus<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="coMULTI">/** Timeout for point blank shots */</span></pre></li><li class="li2"><pre class="de2">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Flak Cannon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">float</span> MaxBonusTime<span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShardMain.cpp</b> - Set default properties in constructor
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	CenteredMomentumBonus <span class="sy1">=</span> <span class="nu0">90000</span> <span class="sy2">*</span> UT3_TO_UT4_SCALE<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	CenteredDamageBonus <span class="sy1">=</span> <span class="nu16">100.0</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	MaxBonusTime <span class="sy1">=</span> <span class="nu16">0.2</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShardMain.cpp</b> - Override GetDamage() &amp; GetMomentum() to return adjusted valued
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="coMULTI">/**</span></pre></li><li class="li1"><pre class="de1"><span class="coMULTI">* Increase damage to UTPawns based on how centered this shard is on target.  If it is within the time MaxBonusTime time period.</span></pre></li><li class="li1"><pre class="de1"><span class="coMULTI">* e.g. point blank shot with the flak cannon you will do mega damage.  Once MaxBonusTime passes then this shard becomes a normal shard.</span></pre></li><li class="li1"><pre class="de1"><span class="coMULTI">*/</span></pre></li><li class="li2"><pre class="de2"><span class="kw4">float</span> AUTProj_FlakShardMain<span class="sy4">::</span><span class="me2">GetDamage</span><span class="br0">&#40;</span>AActor<span class="sy2">*</span> OtherActor, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> HitLocation<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">const</span> <span class="kw4">float</span> CalculatedDamage <span class="sy1">=</span> Super<span class="sy4">::</span><span class="me2">GetDamage</span><span class="br0">&#40;</span>OtherActor, HitLocation<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="co1">// When hitting a pawn within bonus point blank time</span></pre></li><li class="li2"><pre class="de2">	AUTCharacter<span class="sy2">*</span> OtherCharacter <span class="sy1">=</span> Cast<span class="sy1">&lt;</span>AUTCharacter<span class="sy1">&gt;</span><span class="br0">&#40;</span>OtherActor<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">const</span> <span class="kw4">float</span> BonusTime <span class="sy1">=</span> GetLifeSpan<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy2">-</span> InitialLifeSpan <span class="sy2">+</span> MaxBonusTime<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span>CalculatedDamage <span class="sy1">&gt;</span> <span class="nu0">0</span>.<span class="me1">f</span> <span class="sy3">&amp;&amp;</span> OtherCharacter <span class="sy3">!</span><span class="sy1">=</span> <span class="kw2">NULL</span> <span class="sy3">&amp;&amp;</span> BonusTime <span class="sy1">&gt;</span> <span class="nu0">0</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		<span class="co1">// Apply bonus damage</span></pre></li><li class="li2"><pre class="de2">		<span class="kw4">const</span> <span class="kw4">float</span> CharacterRadius <span class="sy1">=</span> OtherCharacter<span class="sy2">-</span><span class="sy1">&gt;</span>GetSimpleCollisionRadius<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw4">const</span> <span class="kw4">float</span> OffCenterDistance <span class="sy1">=</span> FMath<span class="sy4">::</span><span class="me2">PointDistToLine</span><span class="br0">&#40;</span>OtherActor<span class="sy2">-</span><span class="sy1">&gt;</span>GetActorLocation<span class="br0">&#40;</span><span class="br0">&#41;</span>, GetVelocity<span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">SafeNormal</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, HitLocation<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw4">const</span> <span class="kw4">float</span> OffCenterMultiplier <span class="sy1">=</span> FMath<span class="sy4">::</span><span class="me2">Max</span><span class="br0">&#40;</span><span class="nu0">0</span>.<span class="me1">f</span>, <span class="nu0">2</span>.<span class="me1">f</span> <span class="sy2">*</span> <span class="br0">&#40;</span>CharacterRadius <span class="sy2">-</span> OffCenterDistance<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy2">/</span> CharacterRadius<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw4">const</span> <span class="kw4">float</span> BonusDamage <span class="sy1">=</span> CenteredDamageBonus <span class="sy2">*</span> BonusTime <span class="sy2">*</span> OffCenterMultiplier<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw1">return</span> CalculatedDamage <span class="sy2">+</span> BonusDamage<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">return</span> CalculatedDamage<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1"><span class="coMULTI">/**</span></pre></li><li class="li2"><pre class="de2"><span class="coMULTI">* Increase momentum imparted based on how recently this shard was fired</span></pre></li><li class="li1"><pre class="de1"><span class="coMULTI">*/</span></pre></li><li class="li1"><pre class="de1"><span class="kw4">float</span> AUTProj_FlakShardMain<span class="sy4">::</span><span class="me2">GetMomentum</span><span class="br0">&#40;</span>AActor<span class="sy2">*</span> OtherActor, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> HitLocation<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	<span class="co1">// When hitting something within bonus point blank time</span></pre></li><li class="li2"><pre class="de2">	<span class="kw4">const</span> <span class="kw4">float</span> Momentum <span class="sy1">=</span> Super<span class="sy4">::</span><span class="me2">GetMomentum</span><span class="br0">&#40;</span>OtherActor, HitLocation<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">const</span> <span class="kw4">float</span> BonusTime <span class="sy1">=</span> GetLifeSpan<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy2">-</span> InitialLifeSpan <span class="sy2">+</span> MaxBonusTime<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span>BonusTime <span class="sy1">&gt;</span> <span class="nu0">0</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		<span class="co1">// Apply bonus momentum</span></pre></li><li class="li2"><pre class="de2">		<span class="kw1">return</span> Momentum <span class="sy2">+</span> CenteredMomentumBonus <span class="sy2">*</span> BonusTime<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="kw1">return</span> Momentum<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<p><br />
</p>
<h3><span class="mw-headline" id="Making_Flak_Shell_spawn_additional_shards_on_explosion">Making Flak Shell spawn additional shards on explosion</span></h3>
<p>Flak Shell should spawn 5 shards on explosion. The shards should fly away from hit surface.
</p>
<div class="toccolours mw-collapsible">
<p><b>AUTProj_FlakShell.h</b> - Add properties to FlakShell for number of shards to spawn, angle to spawn and class to use.
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	<span class="coMULTI">/** Number of shards to spawn */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Flak Cannon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">int32</span> ShardSpawnCount<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	<span class="coMULTI">/** Angle for spawning shards, relative to hit normal */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Flak Cannon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">float</span> ShardSpawnAngle<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="coMULTI">/** Shard class type */</span></pre></li><li class="li2"><pre class="de2">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Flak Cannon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	TSubclassOf<span class="sy1">&lt;</span>AUTProjectile<span class="sy1">&gt;</span> ShardClass<span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShell.cpp</b> - Set default properties in FlakShell constructor
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	ShardClass <span class="sy1">=</span> AUTProj_FlakShard<span class="sy4">::</span><span class="me2">StaticClass</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	ShardSpawnCount <span class="sy1">=</span> <span class="nu0">5</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	ShardSpawnAngle <span class="sy1">=</span> <span class="nu0">85</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTProj_FlakShell.cpp</b> - Override Explode_Implementation() to spawn additional projectiles
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="kw4">void</span> AUTProj_FlakShell<span class="sy4">::</span><span class="me2">Explode_Implementation</span><span class="br0">&#40;</span><span class="kw4">const</span> FVector<span class="sy3">&amp;</span> HitLocation, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> HitNormal<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	<span class="co1">// On explosion spawn additional flak shards</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy3">!</span>bExploded <span class="sy3">&amp;&amp;</span> Role <span class="sy1">==</span> ROLE_Authority <span class="sy3">&amp;&amp;</span> ShardClass <span class="sy3">&amp;&amp;</span> ShardSpawnCount <span class="sy1">&gt;</span> <span class="nu0">0</span><span class="br0">&#41;</span></pre></li><li class="li2"><pre class="de2">	<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		<span class="co1">// Setup spawn parameters</span></pre></li><li class="li1"><pre class="de1">		FActorSpawnParameters Params<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		Params.<span class="me1">Instigator</span> <span class="sy1">=</span> Instigator<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		Params.<span class="me1">Owner</span> <span class="sy1">=</span> Instigator<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">		Params.<span class="me1">bNoCollisionFail</span> <span class="sy1">=</span> <span class="kw2">true</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">		<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int32</span> i <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span> i <span class="sy1">&lt;</span> ShardSpawnCount<span class="sy4">;</span> <span class="sy2">++</span>i<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">			<span class="co1">// Randomize spawn direction along hit normal</span></pre></li><li class="li2"><pre class="de2">			<span class="kw4">const</span> FRotator SpawnRotation <span class="sy1">=</span> FMath<span class="sy4">::</span><span class="me2">VRandCone</span><span class="br0">&#40;</span>HitNormal, FMath<span class="sy4">::</span><span class="me2">DegreesToRadians</span><span class="br0">&#40;</span>ShardSpawnAngle<span class="br0">&#41;</span><span class="br0">&#41;</span>.<span class="me1">Rotation</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">			<span class="co1">// Spawn shard</span></pre></li><li class="li1"><pre class="de1">			GetWorld<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy2">-</span><span class="sy1">&gt;</span>SpawnActor<span class="sy1">&lt;</span>AUTProjectile<span class="sy1">&gt;</span><span class="br0">&#40;</span>ShardClass, HitLocation, SpawnRotation, Params<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#125;</span></pre></li><li class="li2"><pre class="de2">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	Super<span class="sy4">::</span><span class="me2">Explode_Implementation</span><span class="br0">&#40;</span>HitLocation, HitNormal<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<p><br />
</p>
<h3><span class="mw-headline" id="Spawning_multiple_shards_at_once">Spawning multiple shards at once</span></h3>
<p>Last but not least, we're going to add ability to spawn multiple projectiles at once from a weapon.
</p>
<div class="toccolours mw-collapsible">
<p><b>AUTWeapon_Boom.h</b> - Add properties for number of projectiles to fire and class for additional projectiles
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	<span class="coMULTI">/** Number of projectiles to fire.</span></pre></li><li class="li1"><pre class="de1"><span class="coMULTI">	  * When firing multiple projectiles at once, main projectile will be fired at crosshair.</span></pre></li><li class="li1"><pre class="de1"><span class="coMULTI">	  * Remaining projectiles will be fired in a circle pattern */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Weapon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li2"><pre class="de2">	TArray<span class="sy1">&lt;</span><span class="kw4">int32</span><span class="sy1">&gt;</span> MultiShotCount<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="coMULTI">/** Projectile class to use when firing multiple projectiles at once.</span></pre></li><li class="li1"><pre class="de1"><span class="coMULTI">	  * This is only for additional projectiles, main projectile will use ProjClass. </span></pre></li><li class="li1"><pre class="de1"><span class="coMULTI">	  * If not specified, ProjClass will be used. */</span></pre></li><li class="li2"><pre class="de2">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Weapon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	TArray<span class="sy1">&lt;</span> TSubclassOf<span class="sy1">&lt;</span>AUTProjectile<span class="sy1">&gt;</span> <span class="sy1">&gt;</span> MultiShotProjClass<span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTWeapon_Boom.cpp</b> - Override FireProjectile() to spawn multiple projectiles at once. In this snippet projectiles will be spawned using default weapon's spread.
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">AUTProjectile<span class="sy2">*</span> AUTWeapon_Boom<span class="sy4">::</span><span class="me2">FireProjectile</span><span class="br0">&#40;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span>GetUTOwner<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy1">==</span> <span class="kw2">NULL</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">		UE_LOG<span class="br0">&#40;</span>UT, Warning, TEXT<span class="br0">&#40;</span><span class="st0">&quot;%s::FireProjectile(): Weapon is not owned (owner died during firing sequence)&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw1">return</span> <span class="kw2">NULL</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">&#40;</span>Role <span class="sy1">==</span> ROLE_Authority<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">		<span class="co1">// try and fire a projectile</span></pre></li><li class="li1"><pre class="de1">		checkSlow<span class="br0">&#40;</span>ProjClass.<span class="me1">IsValidIndex</span><span class="br0">&#40;</span>CurrentFireMode<span class="br0">&#41;</span> <span class="sy3">&amp;&amp;</span> ProjClass<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span> <span class="sy3">!</span><span class="sy1">=</span> <span class="kw2">NULL</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">		<span class="co1">// increment 3rd person muzzle flash count</span></pre></li><li class="li1"><pre class="de1">		UTOwner<span class="sy2">-</span><span class="sy1">&gt;</span>IncrementFlashCount<span class="br0">&#40;</span>CurrentFireMode<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">		<span class="co1">// Setup spawn parameters</span></pre></li><li class="li1"><pre class="de1">		FActorSpawnParameters Params<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		Params.<span class="me1">Instigator</span> <span class="sy1">=</span> UTOwner<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		Params.<span class="me1">Owner</span> <span class="sy1">=</span> UTOwner<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">		Params.<span class="me1">bNoCollisionFail</span> <span class="sy1">=</span> <span class="kw2">true</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">		<span class="co1">// Get muzzle location and rotation</span></pre></li><li class="li1"><pre class="de1">		<span class="kw4">const</span> FVector SpawnLocation <span class="sy1">=</span> GetFireStartLoc<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw4">const</span> FRotator SpawnRotation <span class="sy1">=</span> GetAdjustedAim<span class="br0">&#40;</span>SpawnLocation<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">		<span class="co1">// Fire projectiles</span></pre></li><li class="li1"><pre class="de1">		AUTProjectile<span class="sy2">*</span> MainProjectile <span class="sy1">=</span> <span class="kw2">NULL</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw1">if</span> <span class="br0">&#40;</span>MultiShotCount.<span class="me1">IsValidIndex</span><span class="br0">&#40;</span>CurrentFireMode<span class="br0">&#41;</span> <span class="sy3">&amp;&amp;</span> MultiShotCount<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span> <span class="sy1">&gt;</span> <span class="nu0">1</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">			<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int32</span> i <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span> i <span class="sy1">&lt;</span> MultiShotCount<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span><span class="sy4">;</span> <span class="sy2">++</span>i<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">				<span class="co1">// Get firing location and rotation for this projectile</span></pre></li><li class="li1"><pre class="de1">				<span class="kw4">const</span> FVector MultiShotLocation <span class="sy1">=</span> GetFireStartLoc<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">				<span class="kw4">const</span> FRotator MultiShotRotation <span class="sy1">=</span> GetAdjustedAim<span class="br0">&#40;</span>SpawnLocation<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">				<span class="co1">// Get projectile class</span></pre></li><li class="li1"><pre class="de1">				TSubclassOf<span class="sy1">&lt;</span>AUTProjectile<span class="sy1">&gt;</span> ProjectileClass <span class="sy1">=</span> ProjClass<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">				<span class="kw1">if</span> <span class="br0">&#40;</span>i <span class="sy3">!</span><span class="sy1">=</span> <span class="nu0">0</span> <span class="sy3">&amp;&amp;</span> MultiShotProjClass.<span class="me1">IsValidIndex</span><span class="br0">&#40;</span>CurrentFireMode<span class="br0">&#41;</span> <span class="sy3">&amp;&amp;</span> MultiShotProjClass<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span> <span class="sy3">!</span><span class="sy1">=</span> <span class="kw2">NULL</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">				<span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">					ProjectileClass <span class="sy1">=</span> MultiShotProjClass<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">				<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">				<span class="co1">// Spawn projectile</span></pre></li><li class="li1"><pre class="de1">				AUTProjectile<span class="sy2">*</span> MultiShot <span class="sy1">=</span> GetWorld<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy2">-</span><span class="sy1">&gt;</span>SpawnActor<span class="sy1">&lt;</span>AUTProjectile<span class="sy1">&gt;</span><span class="br0">&#40;</span>ProjectileClass, MultiShotLocation, MultiShotRotation, Params<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">				<span class="kw1">if</span> <span class="br0">&#40;</span>MainProjectile <span class="sy1">==</span> <span class="kw2">NULL</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">				<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">					MainProjectile <span class="sy1">=</span> MultiShot<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">				<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">			<span class="br0">&#125;</span></pre></li><li class="li2"><pre class="de2">		<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw1">else</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">			<span class="co1">// Spawn projectile</span></pre></li><li class="li1"><pre class="de1">			MainProjectile <span class="sy1">=</span> GetWorld<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy2">-</span><span class="sy1">&gt;</span>SpawnActor<span class="sy1">&lt;</span>AUTProjectile<span class="sy1">&gt;</span><span class="br0">&#40;</span>ProjClass<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span>, SpawnLocation, SpawnRotation, Params<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">		<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw1">return</span> MainProjectile<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">else</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">		<span class="kw1">return</span> <span class="kw2">NULL</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
<p>This will spawn MultiShotCount projectiles on firing. 
</p>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTWeap_FlakCannon.cpp</b> - Add multishot default properties
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	MultiShotCount.<span class="me1">SetNumZeroed</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	MultiShotCount<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="sy1">=</span> <span class="nu0">9</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	MultiShotProjClass.<span class="me1">SetNumZeroed</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	MultiShotProjClass<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="sy1">=</span> AUTProj_FlakShard<span class="sy4">::</span><span class="me2">StaticClass</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<p><br />
</p>
<h4><span class="mw-headline" id="Projectile_firing_pattern">Projectile firing pattern</span></h4>
<p>Flak Cannon fires shards in distinct semi-random pattern. Main shard is fired at crosshair. Each additional projectile then is fired at equally spaced fragment of firing cone circle. Slight location &amp; rotation randomization is still applied but the shards are guaranteed to cover entire firing cone. This makes the weapon more predictable which is good for pro gaming. We're going to implement this pattern as default for multi-shot weapons. 
</p><p><br />
</p>
<div class="toccolours mw-collapsibled">
<p><b>AUTWeapon_Boom.h</b> - Add property for angle of firing pattern and two functions to return firing location &amp; rotation of individual projectiles.
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	<span class="coMULTI">/** Firing cone angle in degrees.</span></pre></li><li class="li1"><pre class="de1"><span class="coMULTI">	  * Applies to individual projectiles when firing multiple at once. */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Weapon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	TArray<span class="sy1">&lt;</span>FRotator<span class="sy1">&gt;</span> MultiShotAngle<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="coMULTI">/** Returns projectile spawn location when firing multiple projectiles at once */</span></pre></li><li class="li1"><pre class="de1">	UFUNCTION<span class="br0">&#40;</span>BlueprintCallable, BlueprintNativeEvent, Category <span class="sy1">=</span> <span class="st0">&quot;Weapon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	FVector GetFireLocationForMultiShot<span class="br0">&#40;</span><span class="kw4">int32</span> MultiShotIndex, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> FireLocation, <span class="kw4">const</span> FRotator<span class="sy3">&amp;</span> FireRotation<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	<span class="coMULTI">/** Returns projectile spawn rotation when firing multiple projectiles at once */</span></pre></li><li class="li1"><pre class="de1">	UFUNCTION<span class="br0">&#40;</span>BlueprintCallable, BlueprintNativeEvent, Category <span class="sy1">=</span> <span class="st0">&quot;Weapon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	FRotator GetFireRotationForMultiShot<span class="br0">&#40;</span><span class="kw4">int32</span> MultiShotIndex, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> FireLocation, <span class="kw4">const</span> FRotator<span class="sy3">&amp;</span> FireRotation<span class="br0">&#41;</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTWeap_FlakCannon.cpp</b> - Add multishot default properties
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	MultiShotAngle.<span class="me1">SetNumZeroed</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	MultiShotAngle<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="sy1">=</span> FRotator<span class="br0">&#40;</span><span class="nu0">0</span>, <span class="nu0">3</span>, <span class="nu0">0</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTWeapon_Boom.cpp</b> - Implement GetFireLocationForMultiShot(). We will add randomization later.
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">FVector AUTWeapon_Boom<span class="sy4">::</span><span class="me2">GetFireLocationForMultiShot_Implementation</span><span class="br0">&#40;</span><span class="kw4">int32</span> MultiShotIndex, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> FireLocation, <span class="kw4">const</span> FRotator<span class="sy3">&amp;</span> FireRotation<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	<span class="co1">// Main projectile fires straight from muzzle center</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">return</span> FireLocation<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTWeapon_Boom.cpp</b> - Implement GetFireRotationForMultiShot(). We will add randomization later.
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">FRotator AUTWeapon_Boom<span class="sy4">::</span><span class="me2">GetFireRotationForMultiShot_Implementation</span><span class="br0">&#40;</span><span class="kw4">int32</span> MultiShotIndex, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> FireLocation, <span class="kw4">const</span> FRotator<span class="sy3">&amp;</span> FireRotation<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span>MultiShotIndex <span class="sy1">&gt;</span> <span class="nu0">0</span> <span class="sy3">&amp;&amp;</span> MultiShotAngle.<span class="me1">IsValidIndex</span><span class="br0">&#40;</span>CurrentFireMode<span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">		<span class="co1">// Each additional projectile can have own fragment of firing cone.</span></pre></li><li class="li1"><pre class="de1">		<span class="co1">// This way there are no empty spots in firing cone due to randomness.</span></pre></li><li class="li1"><pre class="de1">		<span class="co1">// While still randomish, the pattern is predictable, which is good for pro gaming.</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">		<span class="co1">// Get direction at fragment of firing cone</span></pre></li><li class="li2"><pre class="de2">		<span class="kw4">const</span> <span class="kw4">float</span> Alpha <span class="sy1">=</span> <span class="br0">&#40;</span><span class="kw4">float</span><span class="br0">&#41;</span><span class="br0">&#40;</span>MultiShotIndex <span class="sy2">-</span> <span class="nu0">1</span><span class="br0">&#41;</span> <span class="sy2">/</span> <span class="br0">&#40;</span><span class="kw4">float</span><span class="br0">&#41;</span><span class="br0">&#40;</span>MultiShotCount<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span> <span class="sy2">-</span> <span class="nu0">1</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw4">const</span> FRotator ConeSector <span class="sy1">=</span> FRotator<span class="br0">&#40;</span><span class="nu0">0</span>, <span class="nu0">0</span>, <span class="nu0">360</span>.<span class="me1">f</span> <span class="sy2">*</span> Alpha<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		FVector FireDirection <span class="sy1">=</span> ConeSector.<span class="me1">RotateVector</span><span class="br0">&#40;</span>MultiShotAngle<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span>.<span class="me1">Vector</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">		<span class="co1">// Return firing cone rotated by player's firing rotation</span></pre></li><li class="li2"><pre class="de2">		<span class="kw1">return</span> FireRotation.<span class="me1">RotateVector</span><span class="br0">&#40;</span>FireDirection<span class="br0">&#41;</span>.<span class="me1">Rotation</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="co1">// Main projectile fires straight at crosshair</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">return</span> FireRotation<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTWeapon_Boom.cpp</b> - Modify FireProjectile() so it uses our functions
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">AUTProjectile<span class="sy2">*</span> AUTWeapon_Boom<span class="sy4">::</span><span class="me2">FireProjectile</span><span class="br0">&#40;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span>GetUTOwner<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy1">==</span> <span class="kw2">NULL</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">		UE_LOG<span class="br0">&#40;</span>UT, Warning, TEXT<span class="br0">&#40;</span><span class="st0">&quot;%s::FireProjectile(): Weapon is not owned (owner died during firing sequence)&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw1">return</span> <span class="kw2">NULL</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">&#40;</span>Role <span class="sy1">==</span> ROLE_Authority<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">		<span class="co1">// try and fire a projectile</span></pre></li><li class="li1"><pre class="de1">		checkSlow<span class="br0">&#40;</span>ProjClass.<span class="me1">IsValidIndex</span><span class="br0">&#40;</span>CurrentFireMode<span class="br0">&#41;</span> <span class="sy3">&amp;&amp;</span> ProjClass<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span> <span class="sy3">!</span><span class="sy1">=</span> <span class="kw2">NULL</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">		<span class="co1">// increment 3rd person muzzle flash count</span></pre></li><li class="li1"><pre class="de1">		UTOwner<span class="sy2">-</span><span class="sy1">&gt;</span>IncrementFlashCount<span class="br0">&#40;</span>CurrentFireMode<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">		<span class="co1">// Setup spawn parameters</span></pre></li><li class="li1"><pre class="de1">		FActorSpawnParameters Params<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		Params.<span class="me1">Instigator</span> <span class="sy1">=</span> UTOwner<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		Params.<span class="me1">Owner</span> <span class="sy1">=</span> UTOwner<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">		Params.<span class="me1">bNoCollisionFail</span> <span class="sy1">=</span> <span class="kw2">true</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">		<span class="co1">// Get muzzle location and rotation</span></pre></li><li class="li1"><pre class="de1">		<span class="kw4">const</span> FVector SpawnLocation <span class="sy1">=</span> GetFireStartLoc<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw4">const</span> FRotator SpawnRotation <span class="sy1">=</span> GetAdjustedAim<span class="br0">&#40;</span>SpawnLocation<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">		<span class="co1">// Fire projectiles</span></pre></li><li class="li1"><pre class="de1">		AUTProjectile<span class="sy2">*</span> MainProjectile <span class="sy1">=</span> <span class="kw2">NULL</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw1">if</span> <span class="br0">&#40;</span>MultiShotCount.<span class="me1">IsValidIndex</span><span class="br0">&#40;</span>CurrentFireMode<span class="br0">&#41;</span> <span class="sy3">&amp;&amp;</span> MultiShotCount<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span> <span class="sy1">&gt;</span> <span class="nu0">1</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">			<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int32</span> i <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span> i <span class="sy1">&lt;</span> MultiShotCount<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span><span class="sy4">;</span> <span class="sy2">++</span>i<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">				<span class="co1">// Get firing location and rotation for this projectile</span></pre></li><li class="li1 ln-xtra"><pre class="de1">				<span class="kw4">const</span> FVector MultiShotLocation <span class="sy1">=</span> GetFireLocationForMultiShot<span class="br0">&#40;</span>i, SpawnLocation, SpawnRotation<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">				<span class="kw4">const</span> FRotator MultiShotRotation <span class="sy1">=</span> GetFireRotationForMultiShot<span class="br0">&#40;</span>i, SpawnLocation, SpawnRotation<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">				<span class="co1">// Get projectile class</span></pre></li><li class="li1"><pre class="de1">				TSubclassOf<span class="sy1">&lt;</span>AUTProjectile<span class="sy1">&gt;</span> ProjectileClass <span class="sy1">=</span> ProjClass<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">				<span class="kw1">if</span> <span class="br0">&#40;</span>i <span class="sy3">!</span><span class="sy1">=</span> <span class="nu0">0</span> <span class="sy3">&amp;&amp;</span> MultiShotProjClass.<span class="me1">IsValidIndex</span><span class="br0">&#40;</span>CurrentFireMode<span class="br0">&#41;</span> <span class="sy3">&amp;&amp;</span> MultiShotProjClass<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span> <span class="sy3">!</span><span class="sy1">=</span> <span class="kw2">NULL</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">				<span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">					ProjectileClass <span class="sy1">=</span> MultiShotProjClass<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">				<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">				<span class="co1">// Spawn projectile</span></pre></li><li class="li1"><pre class="de1">				AUTProjectile<span class="sy2">*</span> MultiShot <span class="sy1">=</span> GetWorld<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy2">-</span><span class="sy1">&gt;</span>SpawnActor<span class="sy1">&lt;</span>AUTProjectile<span class="sy1">&gt;</span><span class="br0">&#40;</span>ProjectileClass, MultiShotLocation, MultiShotRotation, Params<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">				<span class="kw1">if</span> <span class="br0">&#40;</span>MainProjectile <span class="sy1">==</span> <span class="kw2">NULL</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">				<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">					MainProjectile <span class="sy1">=</span> MultiShot<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">				<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">			<span class="br0">&#125;</span></pre></li><li class="li2"><pre class="de2">		<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw1">else</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">			<span class="co1">// Spawn projectile</span></pre></li><li class="li1"><pre class="de1">			MainProjectile <span class="sy1">=</span> GetWorld<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy2">-</span><span class="sy1">&gt;</span>SpawnActor<span class="sy1">&lt;</span>AUTProjectile<span class="sy1">&gt;</span><span class="br0">&#40;</span>ProjClass<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span>, SpawnLocation, SpawnRotation, Params<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">		<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw1">return</span> MainProjectile<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">else</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">		<span class="kw1">return</span> <span class="kw2">NULL</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<p><br />
</p>
<h5><span class="mw-headline" id="Projectile_firing_pattern_randomization">Projectile firing pattern randomization</span></h5>
<p>Right now projectiles are fired in perfect circle pattern. We're going to randomize starting location and rotation.
</p>
<div class="toccolours mw-collapsible">
<p><b>AUTWeapon_Boom.h</b> - Add properrties for location &amp; rotation randomization
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	<span class="coMULTI">/** Firing location randomness, in unreal units.</span></pre></li><li class="li1"><pre class="de1"><span class="coMULTI">	  * Applies to individual projectiles when firing multiple at once */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Weapon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	TArray<span class="sy1">&lt;</span>FVector<span class="sy1">&gt;</span> MultiShotLocationSpread<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="coMULTI">/** Firing direction randomness, in degrees. </span></pre></li><li class="li1"><pre class="de1"><span class="coMULTI">	  * Applies to individual projectiles when firing multiple at once */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Weapon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	TArray<span class="sy1">&lt;</span><span class="kw4">float</span><span class="sy1">&gt;</span> MultiShotRotationSpread<span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTWeapon_Boom.cpp</b> - Modify GetFireLocationForMultiShot() so it returns adjusted location.
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">FVector AUTWeapon_Boom<span class="sy4">::</span><span class="me2">GetFireLocationForMultiShot_Implementation</span><span class="br0">&#40;</span><span class="kw4">int32</span> MultiShotIndex, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> FireLocation, <span class="kw4">const</span> FRotator<span class="sy3">&amp;</span> FireRotation<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span>MultiShotIndex <span class="sy1">&gt;</span> <span class="nu0">0</span> <span class="sy3">&amp;&amp;</span> MultiShotLocationSpread.<span class="me1">IsValidIndex</span><span class="br0">&#40;</span>CurrentFireMode<span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li2 ln-xtra"><pre class="de2">		<span class="co1">// Randomise each projectile's spawn location if needed.</span></pre></li><li class="li1 ln-xtra"><pre class="de1">		<span class="kw1">return</span> FireLocation <span class="sy2">+</span> FireRotation.<span class="me1">RotateVector</span><span class="br0">&#40;</span>FMath<span class="sy4">::</span><span class="me2">VRand</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy2">*</span> MultiShotLocationSpread<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="co1">// Main projectile fires straight from muzzle center</span></pre></li><li class="li2"><pre class="de2">	<span class="kw1">return</span> FireLocation<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTWeapon_Boom.cpp</b> - Modify GetFireRotationForMultiShot() so it returns adjusted rotation.
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">FRotator AUTWeapon_Boom<span class="sy4">::</span><span class="me2">GetFireRotationForMultiShot_Implementation</span><span class="br0">&#40;</span><span class="kw4">int32</span> MultiShotIndex, <span class="kw4">const</span> FVector<span class="sy3">&amp;</span> FireLocation, <span class="kw4">const</span> FRotator<span class="sy3">&amp;</span> FireRotation<span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span>MultiShotIndex <span class="sy1">&gt;</span> <span class="nu0">0</span> <span class="sy3">&amp;&amp;</span> MultiShotAngle.<span class="me1">IsValidIndex</span><span class="br0">&#40;</span>CurrentFireMode<span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">		<span class="co1">// Each additional projectile can have own fragment of firing cone.</span></pre></li><li class="li1"><pre class="de1">		<span class="co1">// This way there are no empty spots in firing cone due to randomness.</span></pre></li><li class="li1"><pre class="de1">		<span class="co1">// While still randomish, the pattern is predictable, which is good for pro gaming.</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">		<span class="co1">// Get direction at fragment of firing cone</span></pre></li><li class="li2"><pre class="de2">		<span class="kw4">const</span> <span class="kw4">float</span> Alpha <span class="sy1">=</span> <span class="br0">&#40;</span><span class="kw4">float</span><span class="br0">&#41;</span><span class="br0">&#40;</span>MultiShotIndex <span class="sy2">-</span> <span class="nu0">1</span><span class="br0">&#41;</span> <span class="sy2">/</span> <span class="br0">&#40;</span><span class="kw4">float</span><span class="br0">&#41;</span><span class="br0">&#40;</span>MultiShotCount<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span> <span class="sy2">-</span> <span class="nu0">1</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw4">const</span> FRotator ConeSector <span class="sy1">=</span> FRotator<span class="br0">&#40;</span><span class="nu0">0</span>, <span class="nu0">0</span>, <span class="nu0">360</span>.<span class="me1">f</span> <span class="sy2">*</span> Alpha<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		FVector FireDirection <span class="sy1">=</span> ConeSector.<span class="me1">RotateVector</span><span class="br0">&#40;</span>MultiShotAngle<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span>.<span class="me1">Vector</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1 ln-xtra"><pre class="de1">		<span class="co1">// Randomise each projectile's spawn rotation if needed </span></pre></li><li class="li2 ln-xtra"><pre class="de2">		<span class="kw1">if</span> <span class="br0">&#40;</span>MultiShotRotationSpread.<span class="me1">IsValidIndex</span><span class="br0">&#40;</span>CurrentFireMode<span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">		<span class="br0">&#123;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">			FireDirection <span class="sy1">=</span> FMath<span class="sy4">::</span><span class="me2">VRandCone</span><span class="br0">&#40;</span>FireDirection, FMath<span class="sy4">::</span><span class="me2">DegreesToRadians</span><span class="br0">&#40;</span>MultiShotRotationSpread<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1 ln-xtra"><pre class="de1">		<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">		<span class="co1">// Return firing cone rotated by player's firing rotation</span></pre></li><li class="li1"><pre class="de1">		<span class="kw1">return</span> FireRotation.<span class="me1">RotateVector</span><span class="br0">&#40;</span>FireDirection<span class="br0">&#41;</span>.<span class="me1">Rotation</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="co1">// Main projectile fires straight at crosshair</span></pre></li><li class="li2"><pre class="de2">	<span class="kw1">return</span> FireRotation<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTWeap_FlakCannon.cpp</b> - Add firing pattern default properties
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	MultiShotLocationSpread.<span class="me1">SetNumZeroed</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	MultiShotLocationSpread<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="sy1">=</span> FVector<span class="br0">&#40;</span><span class="nu0">0</span>, <span class="nu0">3</span>, <span class="nu0">3</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	MultiShotRotationSpread.<span class="me1">SetNumZeroed</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	MultiShotRotationSpread<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="sy1">=</span> <span class="nu0">3</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<p><br />
</p>
<h3><span class="mw-headline" id="Camera_Shake">Camera Shake</span></h3>
<p>We can add camera shake as well to our base class. This way it can be used by all weapons.
</p>
<div class="toccolours mw-collapsible">
<p><b>AUTWeapon_Boom.h</b> - Add camera shake properties and function
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="coMULTI">/** delay between firing and camera shake being played */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Weapon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	TArray<span class="sy1">&lt;</span><span class="kw4">float</span><span class="sy1">&gt;</span> CameraShakeDelay<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="coMULTI">/** how strong camera shake should be */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Weapon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	TArray<span class="sy1">&lt;</span><span class="kw4">float</span><span class="sy1">&gt;</span> CameraShakeScale<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	<span class="coMULTI">/** camera shake type */</span></pre></li><li class="li1"><pre class="de1">	UPROPERTY<span class="br0">&#40;</span>EditAnywhere, BlueprintReadWrite, Category <span class="sy1">=</span> <span class="st0">&quot;Weapon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	TArray<span class="sy1">&lt;</span> TSubclassOf<span class="sy1">&lt;</span><span class="kw2">class</span> UCameraShake<span class="sy1">&gt;</span> <span class="sy1">&gt;</span> CameraShakeType<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="coMULTI">/** Plays camera shake immediately */</span></pre></li><li class="li2"><pre class="de2">	UFUNCTION<span class="br0">&#40;</span>BlueprintCallable, BlueprintNativeEvent, Category <span class="sy1">=</span> <span class="st0">&quot;Weapon&quot;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw4">void</span> PlayCameraShake<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTWeapon_Boom.cpp</b> - Add PlayCameraShake() implementation
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="kw4">void</span> AUTWeapon_Boom<span class="sy4">::</span><span class="me2">PlayCameraShake_Implementation</span><span class="br0">&#40;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span>UTOwner <span class="sy3">!</span><span class="sy1">=</span> <span class="kw2">NULL</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li2"><pre class="de2">		AUTPlayerController<span class="sy2">*</span> PC <span class="sy1">=</span> Cast<span class="sy1">&lt;</span>AUTPlayerController<span class="sy1">&gt;</span><span class="br0">&#40;</span>UTOwner<span class="sy2">-</span><span class="sy1">&gt;</span>Controller<span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		<span class="kw1">if</span> <span class="br0">&#40;</span>PC <span class="sy3">!</span><span class="sy1">=</span> <span class="kw2">NULL</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">			<span class="co1">// Play camera shake</span></pre></li><li class="li1"><pre class="de1">			<span class="kw1">if</span> <span class="br0">&#40;</span>CameraShakeType.<span class="me1">IsValidIndex</span><span class="br0">&#40;</span>CurrentFireMode<span class="br0">&#41;</span> <span class="sy3">&amp;&amp;</span> CameraShakeType<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span> <span class="sy3">!</span><span class="sy1">=</span> <span class="kw2">NULL</span> <span class="sy3">&amp;&amp;</span> CameraShakeScale.<span class="me1">IsValidIndex</span><span class="br0">&#40;</span>CurrentFireMode<span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li2"><pre class="de2">			<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">				PC<span class="sy2">-</span><span class="sy1">&gt;</span>ClientPlayCameraShake<span class="br0">&#40;</span>CameraShakeType<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span>, CameraShakeScale<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">			<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li2"><pre class="de2"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTWeapon_Boom.cpp</b> - Override PlayFiringEffects() so it calls our PlayCameraShake() function
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1"><span class="kw4">void</span> AUTWeapon_Boom<span class="sy4">::</span><span class="me2">PlayFiringEffects</span><span class="br0">&#40;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">	Super<span class="sy4">::</span><span class="me2">PlayFiringEffects</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	<span class="co1">// Play camera shake after optional delay</span></pre></li><li class="li1"><pre class="de1">	<span class="kw1">if</span> <span class="br0">&#40;</span>CameraShakeDelay.<span class="me1">IsValidIndex</span><span class="br0">&#40;</span>CurrentFireMode<span class="br0">&#41;</span> <span class="sy3">&amp;&amp;</span> CameraShakeDelay<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span> <span class="sy1">&gt;</span> <span class="nu0">0</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		GetWorldTimerManager<span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">SetTimer</span><span class="br0">&#40;</span><span class="kw3">this</span>, <span class="sy3">&amp;</span>AUTWeapon_Boom<span class="sy4">::</span><span class="me2">PlayCameraShake</span>, CameraShakeDelay<span class="br0">&#91;</span>CurrentFireMode<span class="br0">&#93;</span>, <span class="kw2">false</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li2"><pre class="de2">	<span class="kw1">else</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		PlayCameraShake<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1"><span class="br0">&#125;</span></pre></li></ol></div></div>
</div>
</div>
<div class="toccolours mw-collapsible mw-collapsed">
<p><b>AUTWeap_FlakCannon.cpp</b> - Add CameraShake assets &amp; default properties to FlakCannon constructor
</p>
<div class="mw-collapsible-content">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><ol><li class="li1"><pre class="de1">	<span class="kw4">struct</span> FConstructorStatics</pre></li><li class="li1"><pre class="de1">	<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		...</pre></li><li class="li1"><pre class="de1">		<span class="me1">ConstructorHelpers</span><span class="sy4">::</span><span class="me2">FClassFinder</span><span class="sy1">&lt;</span>UCameraShake<span class="sy1">&gt;</span> CameraShakeType0<span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">		ConstructorHelpers<span class="sy4">::</span><span class="me2">FClassFinder</span><span class="sy1">&lt;</span>UCameraShake<span class="sy1">&gt;</span> CameraShakeType1<span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">		FConstructorStatics<span class="br0">&#40;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			...</pre></li><li class="li1"><pre class="de1">			, CameraShakeType0<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;BlueprintGeneratedClass'/Game/RestrictedAssets/Blueprints/WIP/Nick/CameraAnims/Camerashake2.Camerashake2_C'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li1"><pre class="de1">			, CameraShakeType1<span class="br0">&#40;</span>TEXT<span class="br0">&#40;</span><span class="st0">&quot;BlueprintGeneratedClass'/Game/RestrictedAssets/Blueprints/WIP/Nick/CameraAnims/Camerashake2.Camerashake2_C'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre></li><li class="li2"><pre class="de2">		<span class="br0">&#123;</span></pre></li><li class="li1"><pre class="de1">		<span class="br0">&#125;</span></pre></li><li class="li1"><pre class="de1">	<span class="br0">&#125;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	...</pre></li><li class="li2"><pre class="de2">&#160;</pre></li><li class="li1"><pre class="de1">	<span class="me1">CameraShakeType</span>.<span class="me1">SetNumZeroed</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	CameraShakeType<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="sy1">=</span> ConstructorStatics.<span class="me1">CameraShakeType0</span>.<span class="me1">Class</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	CameraShakeType<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy1">=</span> ConstructorStatics.<span class="me1">CameraShakeType1</span>.<span class="me1">Class</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li2"><pre class="de2">	CameraShakeDelay.<span class="me1">SetNumZeroed</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	CameraShakeDelay<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="sy1">=</span> <span class="nu17">0.05f</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	CameraShakeDelay<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy1">=</span> <span class="nu17">0.05f</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">&#160;</pre></li><li class="li1"><pre class="de1">	CameraShakeScale.<span class="me1">SetNumZeroed</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="sy4">;</span></pre></li><li class="li2"><pre class="de2">	CameraShakeScale<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="sy1">=</span> <span class="nu0">1</span>.<span class="me1">f</span><span class="sy4">;</span></pre></li><li class="li1"><pre class="de1">	CameraShakeScale<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy1">=</span> <span class="nu0">1</span>.<span class="me1">f</span><span class="sy4">;</span></pre></li></ol></div></div>
</div>
</div>
<p><br />
</p>
<h2><span class="mw-headline" id="Source_Code">Source Code</span></h2>
<pre>* <a rel="nofollow" class="external free" href="https://github.com/roman-dzieciol/UnrealTournament/commit/1a148e6381233f654aa4a1b84b88e94496c6b0c8">https://github.com/roman-dzieciol/UnrealTournament/commit/1a148e6381233f654aa4a1b84b88e94496c6b0c8</a>
* <a rel="nofollow" class="external free" href="https://github.com/EpicGames/UnrealTournament/pull/26">https://github.com/EpicGames/UnrealTournament/pull/26</a>
</pre>
<!-- 
NewPP limit report
CPU time usage: 0.373 seconds
Real time usage: 0.385 seconds
Preprocessor visited node count: 734/1000000
Preprocessor generated node count: 1456/1000000
Postexpand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key my_wiki:pcache:idhash:1947-0!*!0!!en!*!* and timestamp 20160506062137
 -->
</div>												<div class="printfooter">
				Retrieved from "<a href="https://wiki.unrealengine.com/index.php?title=UT3_Weapons_Tutorial_-_Flak_Cannon&amp;oldid=10610">https://wiki.unrealengine.com/index.php?title=UT3_Weapons_Tutorial_-_Flak_Cannon&amp;oldid=10610</a>"				</div>
												<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="/Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="/Category:Unreal_Tournament" title="Category:Unreal Tournament">Unreal Tournament</a></li><li><a href="/Category:UT_Content_Creation" title="Category:UT Content Creation">UT Content Creation</a></li></ul></div></div>												<div class="visualClear"></div>
							</div>
		</div>
		</div>
		</div>
		
		<div id="footer">
			<div id="brand">

			</div>
			<div id="legal">
				<div id="copyright">
					&copy; 2004-2015, Epic Games, Inc. All rights reserved. Unreal and its logo are Epic's trademarks or registered trademarks in the US and elsewhere.
				</div>
				<div id="terms">
					<a target="_blank" href="http://epicgames.com/tou">TERMS OF USE</a> | <a target="_blank" href="http://epicgames.com/privacynotice">PRIVACY POLICY</a>
				</div>
			</div>
		</div>
	</div>
		<!--<div id="footer" role="contentinfo">
										<ul id="footer-icons" class="noprint">
					<li id="footer-copyrightico">
						<div name="copyright">&#169; 2004-2014, Epic Games, Inc. All rights reserved. Epic Games, Unreal, Unreal Engine, Unreal Tournament, and their respective logos are Epic's trademarks or registered trademarks in the US and elsewhere.</div>
					</li>
					<li id="footer-termsofuseico">
						<div name="termsofuse"><a href="http://epicgames.com/tou" target="_blank">Terms of Use</a></div>
					</li>
					<li id="footer-privacynoticeico">
						<div name="privacynotice"><a href="http://epicgames.com/privacynotice" target="_blank">Privacy Policy</a></div>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>-->
		<script>/*<![CDATA[*/window.jQuery && jQuery.ready();/*]]>*/</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","skins.vector.collapsibleNav"],null,true);
}</script>
<script src="/extensions/EpicSearchSystem/Javascript/Search.js?303"></script>
<script src="https://wiki.unrealengine.com/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=epic&amp;*"></script>
<!-- Served in 0.070 secs. -->		<img src="https://tracking.unrealengine.com/track.png" width="1" height="1">
		<!--<script type="text/javascript">
			setTimeout(function () {
				var a = document.createElement("script");
				var b = document.getElementsByTagName("script")[0];
				a.src = document.location.protocol + "//script.crazyegg.com/pages/scripts/0028/4572.js?" + Math.floor(new Date().getTime() / 3600000);
				a.async = true; a.type = "text/javascript"; b.parentNode.insertBefore(a, b)
			}, 1);
		</script>-->
	</body>
</html>

		